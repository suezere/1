%%
%% This is file `yanputhesis-sample.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% yanputhesis.dtx  (with options: `sample')
%% Copyright (C) 2022 by Shangkun Shen
%% 
%% It may be distributed and/or modified under the conditions of the LaTeX
%% Project Public License, either version 1.3b of this license or (at your
%% option) any later version. The latest version of this license is in
%%     https://www.latex-project.org/lppl.txt
%% and version 1.3b or later is part of all distributions of LaTeX version
%% 2005/12/01 or later.
%%=============================================================================%
%% 设置论文格式（学位、盲评、Adobe 字体）
%%-----------------------------------------------------------------------------%
%% 博士、正常版本、不使用 Adobe 字体
%% \documentclass[lang=chs, degree=phd, blindreview=false, adobe=false]{yanputhesis}
%% 博士、盲评版本、不使用 Adobe 字体
%% \documentclass[lang=chs, degree=phd, blindreview=true, adobe=false]{yanputhesis}
%% 博士、正常版本、强制使用 Windows 系统字体
\documentclass[lang=chs, degree=master, blindreview=false, winfonts=true]{yanputhesis}
%% 硕士、正常版本、不使用 Adobe 字体
%% \documentclass[lang=chs, degree=master, blindreview=false, adobe=false]{yanputhesis}
%% 硕士、盲评版本、不使用 Adobe 字体
%% \documentclass[lang=chs, degree=master, blindreview=true, adobe=false]{yanputhesis}
%%=============================================================================%
%% 导言区：请自行添加额外宏包
%%-----------------------------------------------------------------------------%
\usepackage{blindtext}                                      % 生成无意义文本
\usepackage{metalogo}                                       % 软件标志
\usepackage[binary-units=true]{siunitx}                     % 物理量单位
\usepackage{amsmath}    
                                    % 基础数学库
\usepackage{bm}
%\usepackage{multirow}
%\usepackage{bbm}
%\usepackage{setspace}
%\usepackage{graphicx}  %插入图片的宏包
%\usepackage{float}  %设置图片浮动位置的宏包
%\usepackage{amssymb}
%\usepackage{amsthm}
%\usepackage{amsfonts}
%\renewcommand{\qedsymbol}{\text{}}



%%=============================================================================%
%% 参考文献（也可以是独立文件）
%%-----------------------------------------------------------------------------%
\begin{filecontents}{reference.bib}

\end{filecontents}
%%=============================================================================%
%% 基本信息录入
%%-----------------------------------------------------------------------------%
\title{数据驱动下的无人机\\绳系吊运控制研究\\}{          % 中英文标题
A data-driven research on tethered hoisting \\ control of unmanned aerial vehicle (UAV)
}                                                           % 请自行断行
\author{\blackbox{李晨豪}}{\blackbox{Li Chenhao}}  % 姓名（添加盲评标记）
\date{2025年3月}{March 2025}                                  % 答辩日期
\school{航天学院}{School of Astronautics}% 学院
\major{控制科学与工程}{Control Science and Engineering}                     % 专业 博士请添加 Ph
\advisor{\blackbox{张帆}}{\blackbox{Zhang Fan}}      % 导师（添加盲评标记）
\studentnumber{\blackbox{2022200330}}                                  % 学号
%\funding{本研究得到玄学基金（编号23336666）资助。}{         % 基金资助
%    The present work is supported by Funding of Metaphysics %
%    (Project No：23336666).}                                %
%%=============================================================================%
%% 文档开始
%%-----------------------------------------------------------------------------%
\begin{document}
%%-----------------------------------------------------------------------------%
%% 总前言，包含封皮页、中英文标题、中英文摘要、目录
%%-----------------------------------------------------------------------------%
\frontmatter                                                % 前言部分
\maketitle                                                  % 封皮页及标题页
%-----------------------------------------------------------------------------%
\makeCommitteePage{                                         % 学位论文评阅人
    \reviewers{\fullBlindReview{1}}                         % 和答辩委员会名单
    
    \committee{2025 年 3 月 6 日}{
        \defenseChair{王志刚}{教授}{西北工业大学}
        \committeeMember{刘正雄}{教授}{西北工业大学}
        \committeeMember{常海涛}{副研究员}{西北工业大学}
        \defenseSecretary{沈刚辉}{副教授}{西北工业大学}
    }
}
%%-----------------------------------------------------------------------------%
\begin{abstract}                                            % 中文摘要开始
    凭借优异的垂直起降能力和高机动性，四旋翼无人机在军事和民用领域得到了广泛应用。在工业巡检和物流运输等领域中，利用四旋翼无人机开展空中吊运任务，不仅能够有效应对复杂的地面环境，还可以替代传统机械设备完成物资搬运和投放等工作。绳系无人机凭借其灵活性、通用性、简便性等优势，逐渐成为无人机运输领域的新兴研究热点。然而，由于无人机本身是一个欠驱动控制系统，加之携带载荷的系绳吊挂结构，使得其运动特性更加复杂。在多无人机系统中，吊挂载荷的质量、尺寸不都是完全规则的，系统内不确定系绳拉力对无人机稳定飞行造成影响。因此，无人机绳系吊运系统的稳定控制是一个值得研究的具有挑战性的复杂问题。
    
近年来，数据驱动方法因其能够避免复杂系统高昂的建模成本、适应未知环境和动态变化、实现自主优化等特点，逐渐成为控制领域的重要方法。与传统的基于模型的控制方法相比，数据驱动控制不依赖精确的物理模型，能够直接从数据中学习控制策略，具有更强的适应性、灵活性和优化能力，特别适用于复杂、高维、不确定或动态变化的系统。

本文将探讨数据驱动控制在无人机绳系吊运系统中的应用，重点研究单无人机吊装载荷的高精度跟踪与多无人机协同稳定控制问题，并通过物理引擎仿真和试验验证其有效性。基于以上研究框架，本文的具体研究内容如下：

首先推导了无人机绳系吊运系统的动力学模型。从单个无人机出发，基于牛顿-欧拉法建立了单个四旋翼飞行器的动力学方程，并通过拉格朗日法推导出了单个无人机吊装载荷的混合动力学模型并进行了简化。对于多无人机绳系吊运系统，基于拉格朗日法方程求解了系统的动力学模型，并推导了在载荷状态未知情况下的简化动力学模型。

针对单无人机吊装载荷中的不确定非线性项干扰问题，提出了一种基于数据驱动的控制框架，用于四旋翼飞行器在激进飞行条件下的绳系吊挂载荷控制。受Koopman算子理论启发，设计损失函数并通过深度神经网络进行学习，将有效载荷及无人机自身空气动力产生的力和扭矩建模为一个升维的显式线性动力系统，并通过Lipschitz常数从理论上保证了预测误差的界限，显着提高了预测模型的准确性；将学习得到的动力学模型与无人机的名义动力学系统相结合形成了完整的系统模型，并应用到非线性模型预测控制框架中，验证了方案的有效性。

为了实现多无人机协同吊装系统的稳定控制，结合上述数据驱动的模型预测控制，自动调整系统的模型预测控制器并解决各无人机系绳上拉力分配问题。开发了一种分布式策略梯度算法。采用多层感知网络在线生成自适应归一化超参数，以闭环方式有效地训练这些深度神经网络，直接从轨迹跟踪误差中学习自适应模型预测控制的权重，提高了系统训练时的稳定性和跟踪性能；通过分析系绳上的张力，在多无人机协同吊装系统数据驱动控制方法的基础上提出了一种基于优化的系绳拉力分配方法，在保持系统稳定的同时对编队构型进行优化。

最后，搭建了无人机绳系吊运系统的物理引擎仿真平台和实物试验平台对算法进行了验证。在仿真中，通过多种开源物理引擎对系统进行建模并进行了对比，结果表明，设计的数据驱动控制算法能够有效实现系统对期望轨迹的精确跟踪；在实物试验中，提出了系统的总体设计方案，并进一步细化了器件选型和机构设计，试验结果也验证了算法的有效性。

综上所述，本文对无人机绳系吊运载荷进行了全面的研究，建立了单无人机和多无人机系统的动力学模型，对模型进行了进一步简化；利用了数据驱动方法对单无人机吊装载荷的不确定非线性项干扰进行预测，并补偿到非线性模型预测控制中；设计了一种基于数据驱动的神经网络学习自适应参数，并结合基于优化的系绳拉力分配方法用于多无人机协同吊装搬运系统的稳定控制；搭建了多个物理引擎和真实试验并对所提出算法进行了验证。

    
    \begin{keywords}                                        % 中文关键词开始
        无人机运输 ，  数据驱动控制， 模型预测控制， 模型自适应控制  ， 物理引擎与试验                   %
    \end{keywords}                                          % 中文关键词结束
\end{abstract}                                              % 中文摘要结束
%%-----------------------------------------------------------------------------%
\begin{engabstract}                                         
	Unmanned aerial vehicles (UAVs), known for their excellent vertical take-off and landing capabilities and high maneuverability, are widely used in both military and civilian applications. In industrial inspection and logistics, these UAVs are employed for aerial lifting tasks. They can efficiently handle complex ground environments and replace traditional mechanical equipment for material transport and delivery. Tethered-UAV systems, with their flexibility, versatility, and simplicity, have gradually become a hot research topic in the field of UAV transportation research. However, UAVs are inherently underactuated systems, and the addition of a tethered load complicates their motion characteristics. In multi-UAV systems, the mass and size of the suspended payload are not all completely regular, and the uncertainty of the tether pull within the system has an impact on the stable flight of the UAV. Therefore, stabilizing the control of tethered-UAV systems is a complex and challenging problem that warrants further investigation.
		
	In recent years, data-driven methods have become a key approach in control systems. They offer advantages such as avoiding the high cost of modeling complex systems, adapting to unknown environments, and enabling autonomous optimization. Unlike traditional model-based control methods, data-driven control does not rely on precise physical models. It learns control strategies directly from data. This approach offers better adaptability, flexibility, and optimization. It is especially suitable for complex, high-dimensional, uncertain, or dynamically changing systems.
	
	This paper explores the application of data-driven control in tethered-UAV systems. It focuses on high-precision tracking for a single tethered-UAV systems and the cooperative stabilization control for multi-tethered-UAV systems. The effectiveness of the proposed methods is verified through both physics engine simulations and real-world experiments. Based on the above research framework, the specific research content of this paper is as follows:
	
	First, the dynamic model of the tethered-UAV system is derived. Starting from a single UAV, he kinetic equations of the single UAV are developed based on the Newton-Euler method, and a hybrid kinetic model for a single tethered-UAV systems is derived and simplified by the Lagrange method. For multi-tethered-UAV systems, the dynamics model of the system is modeled based on the Lagrange method, and a simplified dynamics model is derived for the case where the payload state is unknown.
	
	A data-driven control framework based on the uncertain nonlinear term interference problem in single tethered-UAV systems is proposed for tethered-UAV systems control of a UAV under aggressive flight conditions. Inspired by the Koopman operator theory, we design a loss function and use a deep neural network to model the forces and torques generated by the payload and the UAV's aerodynamic forces. This model is treated as an explicit lifted linear system in elevated dimensions. The Lipschitz constant is theoretically employed to bound the prediction error, significantly improving the accuracy of the model. The learned dynamical model is combined with the UAV's nominal dynamical system to form a complete system model. This model is then applied within a nonlinear model predictive control framework to verify the scheme's effectiveness.
	
	In order to realize the stabilization control of multi-tethered-UAV systems, the data-driven model predictive control described above is combined to automatically adjust the model predictive control parameters of the system and to solve the problem of tension distribution on the tethers of each UAV. A distributed strategy gradient algorithm is developed. Adaptive normalized hyperparameters are generated online using multilayer perceptual networks, and these deep neural networks are effectively trained in a closed-loop manner to learn the weights of adaptive model predictive control directly from the trajectory tracking error, which improves the stability and tracking performance of the system during training. By analyzing the tension on the tether, an optimization-based tethering-tension distribution method is proposed on the basis of the data-driven control method of multi-tethered-UAV systems. tension distribution method to optimize the formation configuration while maintaining system stability.
	
	Finally, a physical engine simulation and real-world experiments of tethered-UAV systems are built to verify the algorithm. In the simulation, the system is modeled and compared by a variety of open-source physics engines, and the results show that the designed data-driven control algorithm can effectively realize the system's accurate tracking of the desired trajectory. In the real-world experiments, the overall design scheme of the system is proposed and the device selection and mechanism design are further refined. Test results validate the effectiveness of the algorithm.
	
	In conclusion, this paper provides a comprehensive study of the tethered-UAV system. The dynamical models for both single tethered-UAV systems and multi-tethered-UAV systems are established and further simplified. A data-driven approach is used to predict the uncertain nonlinear disturbances in a single tethered-UAV systems, which are then compensated in the nonlinear model predictive control. An adaptive parameter learning method based on a data-driven neural network is designed, combined with an optimization-based tether tension distribution method, for the stable control of multi-tethered-UAV systems. Multiple physical engine simulations and real-world experiments are carried out to validate the proposed algorithm.
	
   
   
    \begin{engkeywords}                                     % 英文关键词开始
        UAV Transportation \ensep Data-driven Control \ensep Model Predictive Control \ensep Model Reference Adaptive Control \ensep Physics Engine and Experiments         %
    \end{engkeywords}                                       % 英文关键词结束
\end{engabstract}                                           % 英文摘要结束
%%-----------------------------------------------------------------------------%
\tableofcontents                                            % 目录
%\listoffigures                                              % 图目录（学校未做要求）
%\listoftables                                               % 表目录（学校未做要求）
%\printnomenclature                                          % 符号表（学校未做要求）
%%-----------------------------------------------------------------------------%
\mainmatter
\sDefault

\chapter{绪论}
\chaptermark{绪论}
\section{课题研究背景及意义}
随着空中机器人领域的快速发展，作为一种可以自由漂浮的操纵器，四旋翼无人机(UAV，Unmanned Aerial Vehicle) 受到了人们的广泛关注，并在各个方面迅速普及\cite{kimon_advances_2023}。四旋翼无人机具有垂直起降能力，在空中还可以实现全方位的机动，已经被证明可以对城市进行探索和测绘\cite{tomic2012toward}、空中操纵物体\cite{suarez2020benchmarks}以及平衡和空翻等杂技表演\cite{beul2018fast}，同时还可用于快递派送\cite{刘昂2020基于}、森林防火检测\cite{harikumar2018multi}、河流搜索\cite{nuske2015autonomous}、空中运输\cite{klausen2018cooperative}，在军事和民用中都有着广泛的应用前景。

在短距离应急抢修作业中，滑坡中断道路、复杂地形地貌下导致物资运输车辆无法通行是灾害发生后应急抢修的重要阻碍，空中运输速度快、效率高，是解决复杂山区地形应急运输的有效方式之一。相比于直升机作业成本高、受限条件多、准备时间长、使用风险高等不利因素，四旋翼无人机作为简便、灵活的小型航空器具，不受限于仓位尺寸、便于多平台起降、可变构型避障、可多次灵巧往返/停靠于补给站点和孤立单位之间，在复杂地形进行应急抢修作业中具有无可比拟的优势。通过执行抓取、运输等操纵任务，其能够有效解决“最后一公里”物资运输和抢险救灾等问题。

物资运输已成为四旋翼无人机的一项热门应用\cite{cruz2014autonomous}，对于无人机来说，在其对目标载荷进行运输时，可以采用不同的方法，配备额外的机构例如夹具、操纵器或绳系吊运系统等。使用夹具可以将载荷固连在无人机机体机腹或机体下方，该方法简单直接，使载荷保持在接近飞行器重心的位置，有利于提高稳定性，但对目标载荷的形状和尺寸有着严格的约束，也会增加整个系统的惯性，使其功能仅限于执行慢速运动\cite{Khalifa2017}；还可以在机体上挂载操纵器如机械臂、飞爪等刚性体，操作操纵器对目标载荷进行抓取，以实现无人机与外界环境的交互，但加装操纵器不仅造价昂贵，影响无人机的空气动力学特性，同时操纵器与无人机耦合严重，对作业时的稳定飞行控制提出了很高的要求；第三种方式绳系吊运系统就是将目标载荷直接通过柔性系绳挂载在机身下方，与前两种运输方式相比，采用柔性系绳连接目标载荷时不需要考虑运输载荷的形状和大小，其可以适应不同载荷的变化，避免了加装固定载荷的装置，使无人机的灵活性得以保留，增加了吊运的通用性。

系绳吊运载荷运输最初是为紧急响应、救援任务、民用和军事行动中的人力操作直升机而研究的\cite{2020A}。无人机绳系吊运载荷相比其它方法来说有着一系列的优越性，但随之而来的载荷也对无人机产生了一系列的影响。无人机绳系吊运系统是欠驱动和非线性耦合的，此外每个四旋翼无人机的动力学为载荷的摆动运动会引发无人机系统的不稳定性，同时给无人机系统增添了更多的自由度，使得此类系统的控制更具挑战性。

在运输过程中，单无人机在利用吊装方式运输的时候载荷会存在摆动，且当需要运输的载荷重量与无人机系统的载荷重量相当时，任务可能会受到影响。为了解决这些问题，采用多个协作式的无人机绳系吊运系统是一个很有前途的替代方案，即将多架无人机按照期望的队形来分布，并使其在执行任务的过程中保持编队队形平稳飞行，从而圆满完成运输任务。多无人机绳系吊运系统通过根据有效载荷重量适当调整四旋翼无人机的数量，使这种悬挂式有效载荷配置能够实现最大的有效载荷输送效率，此外这种配置还可以有效控制载荷的姿态，解决了单无人机运输载荷出现摆动的问题，甚至在单无人机发生故障时仍可以完成任务需求。因此多无人机吊运载荷具有可行性高、效率高以及扩展性强等单架无人机无法比拟的优势。但是，在依靠多无人机绳系吊运系统执行合作运输任务时，必须考虑一系列全新的因素。整个系统不仅受到载荷摆动的影响，而且还受到其它无人机运动的影响，如果单无人机的独立行动没有得到适当的协调，情况会变得更加复杂。

基于以上问题，本研究拟采用数据驱动方法来研究无人机绳系吊运系统，通过神经网络和无人机的动力学对整个系统进行动力学建模，提出了在线自适应神经元和模型预测控制相结合的控制算法对系绳的摆动进行抑制，在多无人机协同吊运中实现各个无人机功率消耗的均衡化，最终达到对搬运载荷的位姿的控制，有效提高系统的鲁棒性和安全性，为跨越峡谷、陡坡、滑坡体等障碍进行物资运输提供便捷、有效的手段，大大提高应急抢修作业效率，具有重要的应用价值。

\section{国内外研究现状}
\subsection{单无人机绳系吊装载荷控制研究现状}
多旋翼无人机(UAV)运输载荷主要通过固连、刚性连接或柔性连接的方式来进行。无人机绳系吊运具有方便、高效、节省土地资源、不受地形条件影响等优点，因此得到了广泛的应用。大疆今年发布的FlyCart30无人机也加入了空吊系统来实现无接触精准运送[12]。然而，无人机绳系吊运也给控制研究带来了新的挑战，特别是载荷摆动对控制精度的降低，因此对于绳系连接载荷中的无人机在载荷干扰下实现高精度轨迹跟踪控制仍然是一个难点。目前，主要有两种方法解决该问题：一种是将重物视为扰动，并在控制器中对扰动量进行补偿；另一种是利用系统的摆动敏捷性，对无人机绳系吊装载荷系统整体进行建模，设计带有吊装载荷系统的四旋翼无人机的控制器。

对于无人机绳系吊装系统的建模方法，文献[13]假设系留综合缆绳的重力与所受风力作用于综合缆绳中心，且不考虑缆绳的拉伸变形，系留缆绳在自身重力、风的作用下呈现悬链线形状，可以求出无人机在不同位置时缆绳与机体的夹角。文献[14]基于珠点模型对水下系留无人机进行建模。文献[15]在假设缆绳不可拉伸、质量和阻尼可以忽略且具有零剪切刚度的前提下，通过分析二维平面上的无人机与系绳的运动学和动力学关系推导出系绳上的拉力。文献[16]在建立旋翼无人机的动力学模型之后，将系绳建模成无质量的，由一个阻尼单元和一个弹簧单元并联，这两个并联单元再与一个弹簧单元串联的结构。文献[17]将系绳建模为一系列通过非弹性杆连接的点质量块，通过分析这些杆件的动力学特性并进行仿真, 可以体现系绳的柔性。

对于设计带有绳系吊装系统的无人机的控制器方法，卡耐基梅隆大学的Sceenath得到了定义在构型空间SE ( 3 ) × S2上的坐标自由动力学模型，并将其可以看作平坦输出的微分平坦混合系统，并给出了控制器设计的稳定性证明和仿真[18]。华盛顿大学的Lee团队提出了基于拉格朗日动力学在流形上的吊装载荷，将柔性电缆用串行连接的链路进行建模，并用几何非线性控制渐近稳定无人机的位置[19]。墨西哥的Guerrero提出最小化吊装载荷的摆动角度，以实现稳定[20]。香港科技大学的沈劭劼团队设计了一种具有分层扰动补偿策略的自适应NMPC来克服未知外部扰动和模型参数不准确的问题[21]。


\subsection{多无人机绳系吊装载荷运输研究现状}
为了适用于多样的载荷类型，系绳连接的多无人机协同运输方式也被学者们提出。早在 2011 年，Vijay Kumar 教授团队就根据多无人机绳系运输系统与绳驱并联操作机器人的相似性，将绳驱并联操作机器人的控制方法拓展到多无人机绳系运输系统上，对系统精确建模，根据载荷的期望位姿和几何约束，进行逆运动学求解，从而反解出每个无人机期望位置，完成载荷的控制[22]。Lee 使用利用拉格朗日方程的方法对系统建模，使用几何控制的方法，实现了对刚体载荷的精确位姿控制。文献[23]使用了牛顿-欧拉法对系统建模，应用了将机械手多指抓取中的零交互力条件，设计了基于位置的被动控制。文献[24]则是使用了上个世纪 90 年代提出的 Udwadia–Kalaba 方程[25]，可以较为简单的针对多无人机绳系吊运这样的多约束系统求解出其动力学模型，最后应用了 LQR 控制。

以上文献中，由于载荷的存在，默认飞行过程中的系统模型是连续的（即假设绳始终有张力，载荷始终受力，不存在自由落体运动），系统中系绳模型都是作为无质量杆来处理。文献[26]考虑了两架直升机协同运输一个载荷，较为不同的是绳子模型为多弹簧阻尼的柔性模型。文献[27]也从绳驱并联操作机器人受到启发，通过柔性模型考虑了协同运输中绳上的力分配问题。Tognon 教授团队考虑了系统建模中的不确定问题和无人机与载荷的多连接情形[28]。Erskine 团队首先研究了不同无人机期望角度构型下的系统载荷能力[29]，在此基础上还研究了可变绳长的多无人机协同运输系统的载荷控制问题[30]。


\subsection{数据驱动控制研究现状}
使用自主机器人进行快速灵活的机动操作，需要了解平台的精确动力学模型。然而，对于刚柔混合的无人机绳系吊装系统，由于摩擦、空气动力学、绳子上的力突变造成的影响，传统的动力学模型并不总能捕捉到完整的系统行为。因此，在控制无人机时需要在模型的可表达性和计算的可操作性之间找到一个平衡点。随着系统越来越复杂，数据越来越容易获得，很多研究人员开始绕过经典的基于模型的技术，转而采用数据驱动的方法[31]，而无模型和基于模型的数据驱动方法是无人机进行运输和操纵的最优控制策略。

数据驱动方法最早是由Ziegler和Nichols提出的[32]，后来衍生出了自适应控制[33]和神经网络理论[34]。对于无模型的数据驱动方法，文献[35]和[36]发展了数据驱动技术，并用来识别系统的底层模型。文献[37]在各种学习任务中训练一个模型，并适用于各种不同的学习问题。文献[38]提出了一种元学习方法，即在连接飞行数据的几秒内"学习如何学习"变化的动力学模型。然而，这些方法计算量大，对于现实世界的无人机来说，仍然不可能像反馈控制回路一样快速地自适应。

基于模型的数据驱动方法是在已知部分系统动力学模型的基础上，学习其余未知的模型。文献[39]即通过对无人机在风扰中的情形进行快速自适应学习。文献[40]通过将基于BEM理论的最先进旋翼模型与由深度神经网络表示的学习残余力和扭矩项相结合，可以准确捕捉复杂的空气动力效应。

对于基于模型的数据驱动方法，可以将其与传统控制算法结合起来，避免神经网络的数据匮乏。MPC作为一个能够同时处理复杂的非线性动态系统，并满足不同的状态和输入约束的强有力的基于模型的方法[41]，可以很好地和数据驱动方法进行结合。文献[42]通过使用高斯过程对气动效应进行建模的方法，并将其融入MPC中，以实现高效和精确的实时反馈控制。文献[43]将MPC建模为参数化控制器，其中难以优化的决策变量表示为高层策略。文献[44]提出了一个有效集成大型复杂神经网络结构作为动态的实时神经网络模型预测控制(Real-time Neural MPC)框架。

\section{本文主要研究内容}
%基于涡流效应的空间翻滚目标消旋稳定控制，属于电磁消旋方法的一种。
%本文各章节的主要内容介绍如下。

本文的主要研究目标是在保障服务星安全的前提下，尽可能提高电磁消旋的效率。影响电磁消旋效率的主要因素包括章动目标的物理特性和角速度，服务星的磁场强度，服务星与目标间的相对位姿。其中物理特性和角速度由翻滚目标自身决定，服务星的磁场强度存在上限，因此为实现本文目标，需从服务星与目标间的相对位姿入手。服务星与目标间的相对位置决定了所能产生电磁消旋力矩的最大值，因此服务星需尽可能逼近章动目标；服务星与目标间的相对姿态影响着电磁消旋力矩的实际大小与方向，为避免目标翻滚运动加剧，需保证所施加的电磁力矩始终沿目标角动量轴方向。综上所述，服务星应尽可能逼近章动目标并根据当前位置选择合适的相对姿态对目标进行消旋。而空间章动目标往往形状复杂，极近距离下服务星的大小形状也无法忽略，如何实现复杂外形章动目标的极近距离安全逼近，并在目标状态变化后及时调整相对位姿，最大化电磁消旋效率，这些问题都亟待研究。

针对上述问题，本文首先研究了任意外形航天器间的碰撞风险评估问题，给出了任意外形航天器精确安全区域构建方法，并建立了任意外形航天器间的碰撞判定方法；随后，针对极近距离逼近与消旋阶段的不同需求，结合所提出的碰撞风险评估方法，设计了两阶段服务星位姿轨迹规划方法；最后，搭建地面实验系统并开展电磁消旋地面实验，验证所提出方法的有效性。本文各章节内容如下：

第一章为绪论，本章首先概述了本文的研究背景与意义，介绍了空间电磁消旋的优势与实际实施中存在的问题，针对这些问题，阐述了航天器碰撞风险评估方法、安全接近方法等相关理论的研究现状，并给出了本文的研究内容。

第二章为空间电磁消旋机理与问题建模，本章对空间电磁消旋操控场景进行了描述，定义了本文所使用的坐标系。随后给出了基于磁张量理论的电磁力、力矩机理模型，并建立了电磁消旋场景中的相对位姿动力学模型。最后对本文理论的相关概念进行了介绍，给出本文最优消旋位姿与位姿同步规划问题的定义。

第三章为基于混合高斯模型的航天器碰撞风险分析方法，本章采用混合高斯模型给出任意外形航天器安全区域划分方法，根据章动目标特点定义了角动量定向安全区域以解决安全区域的时变问题。接着本章提出基于混合高斯模型的碰撞危险度并给出其解析计算式，以评估不同相对位姿下的碰撞风险。随后，本章确定了碰撞危险度的临界阈值，建立了任意外形航天器间的精确碰撞约束，并进行了相关仿真验证，结果表明所提出的方法准确有效。

第四章为基于引导优化的卫星位姿同步轨迹规划，本章采用引导优化的规划框架，给出了极近距离逼近和极近距离消旋两个阶段服务星的位姿轨迹规划方法。极近距离逼近阶段通过FMT*算法搜索参考逼近路径，并设计优化问题对轨迹控制点和时间分配进行优化，给出满足各项约束的速度平滑位姿轨迹；极近距离消旋阶段中为提高实时性，设计PPO算法给出参考路径，并对轨迹控制点进行优化以最大化消旋力矩。通过仿真分析表明所提出的方法能给出极近距离逼近与消旋位姿轨迹并最大化电磁消旋效率。

第五章为章动目标电磁消旋地面系统实验，本章介绍了章动目标电磁消旋地面实验系统的目的与功能需求，对系统中的主要设备进行了选型设计，完成了实验系统的搭建。根据本文所提出的方法，给出了地面实验中服务星的位姿轨迹，将其转化为机械臂关节角并验证其可行性后，进行了章动目标逼近与电磁消旋地面实验，并与其它消旋策略进行对比验证本文所提出方法的有效性。

第六章为总结与展望，对全文工作进行归纳总结，提出可以进一步改进的内容，为后续研究提供参考。



\cleardoublepage

\chapter{无人机绳系吊运系统建模}
\chaptermark{无人机绳系吊运系统建模}
在本章中，将建立无人机绳系吊运系统的动力学模型。无人机绳系吊运系统由三个子系统构成：四旋翼、系绳以及吊运的载荷，系绳和吊运的载荷会对无人机自身造成一定的扰动。本章首先对四旋翼无人机的动力学模型进行推导，然后建立单无人机绳系吊运系统的动力学方程，进而将其推广到多无人机绳系吊运系统的动力学模型中，以此作为控制模型的基础。

\section{单无人机绳系吊运系统的动力学模型}
四旋翼运输系统是一个复杂的系统，由四个旋翼组成，这些旋翼固定在刚性交叉体上。载荷通过绳系与四旋翼的主体连接，实现对载荷的精确控制和运输。
四旋翼无人机是一种基于旋翼的飞行器，由四个旋翼推动飞行。为了平衡扭矩，转子由两对对置的转子构成，一对正时针转动，一对反时针转动。四旋翼系统是高度非线性的，并且是一个欠驱动系统，有六个自由度和四个控制输入（即旋翼转速）。可以通过调整旋翼的转速来对四旋翼无人机进行控制，从而改变四旋翼无人机的扭矩和推力特性。如图\ref{2_1}所示，四旋翼无人机设计为四个旋翼交叉共振。两个相对的旋翼沿同一方向旋转，通过改变旋翼的角速度可以控制四旋翼无人机的高度和位置。如果电机$T_1$、$T_2$、$T_3$和$T_4$产生的扭矩相同，则四旋翼无人机可以保持平衡位置而不旋转。

\begin{figure}[hbt!]
	\centering
	\includegraphics[width=28pc]{picture/2_1.png} 
	\caption{四旋翼无人机动力学结构} \label{2_1}
\end{figure}


对于四旋翼无人机的上升和下降，可以通过同时增加或减小电机$T_1$、$T_2$、$T_3$和$T_4$的转速来实现；滚转是四旋翼无人机通过向左或向右倾斜，以允许侧向移动的运动；俯仰是指四旋翼无人机通过前倾或后仰，向前或向后运动；偏航是指在与地面保持水平的情况下，以顺时针或逆时针的方式改变四旋翼无人机的方向。四旋翼无人机通过控制四个电机的转速，可以完成不同的飞行作业。本章根据四旋翼无人机的动力学特性建立数学模型，为下面章节控制器的设计奠定基础。


\subsection{四旋翼无人机的坐标系}
为了便于建模和描述，首先引入两个右手直角坐标系的定义，并给出两个坐标系之间的转换关系。
\subsubsection{地面坐标系}
地面坐标系$o_ex_ey_ez_e$用于研究四旋翼无人机相对于地面的运动状态，确定机体的三维位置。一般来说，在地面坐标系中，常用的局部坐标系统有 NED（North-East-Down）和ENU（East-North-Up）两种。NED坐标系$o_ex_e$轴指向正北，$o_ey_e$轴指向正东，$o_ez_e$轴垂直于地面向下。ENU坐标系 $o_ex_e$ 轴指向正东，
$o_ey_e$ 轴指向正北，$o_ez_e$ 轴垂直向上，即指向天空的方向。NED 坐标系适合飞行器或船舶等需要考虑垂直下降的系统；而ENU 坐标系更直观，符合日常地理方向的习惯，常用于地面交通、测量和定位。本文使用NED坐标系，坐标原点选择在固连于地面的任意一点。

\subsubsection{机体坐标系}
本文的四旋翼无人机为“X”型气动布局结构，运动更加灵活。
机体坐标系固连于四旋翼无人机，其原点取在四旋翼无人机的重心位置。$o_bx_b$轴在四旋翼无人机对称平面内指向机头。 $o_bz_b$轴在四旋翼无人机对称平面内，垂直轴向下。$o_by_b$轴按右手定则进行确定。机体坐标系与无人机固定连接，构成一个随四旋翼无人机运动的动坐标系。
\subsubsection{地面坐标系与机体坐标系之间的转换关系}
地面坐标系和机体坐标系的转换在无人机导航与控制中发挥着至关重要的作用。它可以帮助我们理解无人机在空间中的位置和姿态，同时实现精确的导航与控制。地面坐标系与机体坐标系之间的转换关系可以通过三个旋转矩阵来描述。具体来说，可以将地面坐标系依次沿机体坐标系进行旋转，即绕$z_b$轴旋转偏航角$\psi$，绕$y_b$旋转俯仰角$\theta$，绕$x_b$旋转滚转角$\phi$。对应的三个旋转矩阵$\boldsymbol{R}_\psi$、$\boldsymbol{R}_\theta$和$\boldsymbol{R}_\phi$分别为:
$$
\boldsymbol{R}_\psi=\begin{bmatrix}\cos\psi&-\sin\psi&0\\sin\psi&\cos\psi&0\\0&0&1\end{bmatrix} $$
$$	\boldsymbol{R}_\theta=\begin{bmatrix}\cos\theta&0&\sin\theta\\0&1&0\\-\sin\theta&0&\cos\theta\end{bmatrix} $$
$$\boldsymbol{R}_\phi=\begin{bmatrix}1&0&0\\0&\cos\phi&\sin\phi\\0&-\sin\phi&\cos\phi\end{bmatrix}
$$

因此，通过上述三个旋转矩阵，可以得到将任意矢量从地面坐标系转换到机体坐标系的转换矩阵为：
$$\begin{aligned}\boldsymbol{R}_{e-b}&=\boldsymbol{R}_{\psi}\boldsymbol{R}_{\theta}\boldsymbol{R}_{\phi}\\&=\begin{bmatrix}\cos\theta\cos\psi&\cos\theta\cos\psi&-\sin\theta\\\sin\phi\sin\theta\cos\psi-\cos\phi\sin\psi&\sin\phi\sin\theta\sin\psi+\cos\phi\cos\psi&\sin\phi\cos\theta\\\cos\phi\sin\theta\cos\psi+\sin\phi\sin\psi&\cos\phi\sin\theta\sin\psi-\sin\phi\cos\psi&\cos\phi\cos\theta\end{bmatrix}\end{aligned}$$

从机体坐标系到地面坐标系的转换矩阵为：
$$\begin{aligned}\boldsymbol{R}_{b-e}&=\bm{R}_{e-b}^\mathrm{T}\\&=\begin{bmatrix}\cos\theta\cos\psi&\sin\phi\sin\theta\cos\psi-\cos\phi\sin\psi&\cos\phi\sin\theta\cos\psi+\sin\phi\sin\psi\\\cos\theta\cos\psi&\sin\phi\sin\theta\sin\psi+\cos\phi\cos\psi&\cos\phi\sin\theta\sin\psi-\sin\phi\cos\psi\\-\sin\theta&\sin\phi\cos\theta&\cos\phi\cos\theta\end{bmatrix}\end{aligned}$$

\subsection{四旋翼无人机的模型}
四旋翼无人机模型分为运动学模型、动力学模型和控制效率模型，动力学模型既涉及运动又涉及受力情况，与物体的质量和转动惯量相关，主要用于分析无人机的受力对无人机运动速度的影响，输入为无人机旋翼产生的拉力和力矩，输出为无人机的速度和角速度。运动学模型与质量和受力无关，主要分析无人机速度对无人机位置变化产生的影响，输入为速度和角速度，输出为无人机的位置和姿态。控制效率模型输入为螺旋桨转速，输出为拉力和力矩，当已知螺旋桨转速时，可以通过控制效率模型计算出拉力和力矩。

为了简便，在对四旋翼无人机进行建模时，做了如下假设：

(1)四旋翼无人机是刚体结构，没有内力，飞行时结构无形变；

(2)四旋翼无人机的质量、螺旋桨阻力系数和转动惯量等基础参数默认不变；

(3)四旋翼无人机总保持对称结构，其几何中心与重心位置一致。



运动学方程描述了无人机位置与速度以及速度和角速度之间的关系，其运动学方程可以表示为：

\begin{equation}
    \begin{aligned}
	\dot{\boldsymbol{p}}_e &= \boldsymbol{v}_e = \bm{R}_{b-e} \bm{v}_b \\
	\bm{\Theta}_e &= \bm{W}_{b-e} * \bm{\omega}_b
\end{aligned}\label{2-1}
\end{equation}
其中，$\boldsymbol{p}_e=\left[x,y,z\right]^\mathrm{T}$为无人机在地面坐标系下的位置坐标，$\boldsymbol{v}_e=\left[v_{x},v_{y},v_{z}\right]^\mathrm{T}$为无人机在地面坐标系下的线速度，$\boldsymbol{v}_b=\left[u,v,w\right]^\mathrm{T}$表示无人机在机体坐标系下的线速度，$u$、$v$、$w$表示分别沿$x$、
$y$、$z$机体坐标轴方向的线速度分量，$\boldsymbol{R}_{b-e}$为上一小节定义的转换矩阵，$\bm{\Theta}_e=\left[\phi,\theta,\psi\right]^\mathrm{T}$表示无人机在地面坐标系下的姿态角度，$\bm{W}_{b-e}$表示地面坐标系下欧拉角速度变换到机体旋转角速度的旋转矩阵，$\boldsymbol{\omega}_b=\left[{\omega}_{xb},{\omega}_{yb},{\omega}_{zb}\right]^\mathrm{T}$ 为无人机机体坐标系下的角速度，可以得到姿态旋转矩阵具体形式如式(\ref{2-2})所示：
\begin{equation}
	\boldsymbol{\omega}_b=\begin{bmatrix}\omega_{xb}\\\omega_{yb}\\\omega_{zb}\end{bmatrix}=\begin{bmatrix}1&0&-\sin\theta\\0&\cos\phi&\cos\theta\sin\phi\\0&-\sin\phi&\cos\theta\cos\phi\end{bmatrix}\begin{bmatrix}\dot\phi\\\dot\theta\\\dot\psi\end{bmatrix}
	\label{2-2}
\end{equation}



一般来说，四旋翼无人机飞行时其姿态角在小范围内运动，可以近似认为有下式成立：
\begin{equation}
	\boldsymbol{\omega}_b=\begin{bmatrix}{\omega}_x\\{\omega}_y\\{\omega}_z\end{bmatrix}=\begin{bmatrix}\dot{\phi}\\\dot{\theta}\\\dot{\psi}\end{bmatrix}
	\label{2-3}
\end{equation}

以上详细描述了四旋翼无人机系统的运动学模型以及其在不同坐标系下的位置与线速度、角度与角速度之间的转换关系。接下来，将无人机整体视为一个刚体，将其分解为平移运动和旋转运动两个部分。通过牛顿法分析其平移运动，通过欧拉法分析其旋转运动，从而构建其动力学模型。其动力学的基本方程如式(\ref{2-4})所示：
\begin{equation}
	\begin{aligned}
		m\dot{\boldsymbol{v}}_e&=mg\bm{e}_{3}-\boldsymbol{R}_{b-e}f\bm{e}_{3}\\
		\boldsymbol{J}\dot{\boldsymbol{\omega}_b}&=-\bm \omega_b \times \bm J \bm \omega_b+\boldsymbol{\tau}
	\end{aligned}\label{2-4}
\end{equation}
其中$m$为无人机的质量，$g\in\mathbb{R}_+$为重力加速度，$\bm{e_{3}}=\left[0,0,1\right]^\mathrm{T}$，$\boldsymbol{\tau}=\left[\tau_x,\tau_y,\tau_z\right]^\mathrm{T}$表示无人机四个螺旋桨产生的扭矩，$\boldsymbol{J}$为无人机的惯量矩阵，$f\in\mathbb{R}_+\cup\{0\}$表示无人机螺旋桨总拉力的大小，该拉力是单向的,其形式如式 (\ref{2-5})所示：
\begin{equation}
	f=\sum_{i=1}^4f_i=c_\mathrm{T}\Omega_i^2
	\label{2-5}
\end{equation}
其中$f_i$表示表示一个旋翼在机体坐标系下旋转产生的升力，与旋翼的转速的平方正相关。$c_\mathrm{T}=1/4\pi^2\cdot\rho D_\mathrm{p}^4C_\mathrm{T}$为螺旋桨的升力系数，其大小与无人机自身的材质、倾斜角等因素有关，$\Omega_i$为
单个螺旋浆的旋转速度。由于本文采用“X”型气动布局，实际力臂长度是机臂长度的$\sqrt{2}/2$倍，可以得到无人机每个螺旋桨产生的力矩如式(\ref{2-6})所示：


\begin{equation}
	\left\{ \begin{array}{l}
		\tau_x={\sqrt{2}}/{2}dc_\mathrm{T}\left(\Omega_1-\Omega_2-\Omega_3+\Omega_4\right)\\
		\tau_y={\sqrt{2}}/{2}dc_\mathrm{T}\left(\Omega_1+\Omega_2-\Omega_3-\Omega_4\right)\\
		\tau_z=c_\mathrm{M}\left(\Omega_1-\Omega_2+\Omega_3-\Omega_4\right)\\
	\end{array} \right.
		\label{2-6}
\end{equation}
其中$c_M$为螺旋桨的反扭力系数，其产生的力矩方向沿$z$轴方向。$d\in\mathbb{R}_+$为无人机重心和任一电机转动轴线之间的距离。为了能够对应控制器中的控制量，定义虚拟控制变量为$\bm{U}=\left[U_1,U_2,U_3,U_4\right]^\mathrm{T}=\left[f,\tau_x,\tau_y,\tau_z\right]^\mathrm{T}$，那么，将式(\ref{2-2})、(\ref{2-3})、(\ref{2-5})、(\ref{2-6})代入式(\ref{2-1})和(\ref{2-4})中，即可得到四旋翼无人机的控制模型：


\begin{equation}
		\left\{
	\begin{aligned}
		&\dot{x}=v_{x}\\
		&\dot{y}=v_{y}\\
		&\dot{z}=v_{z}\\
		&\ddot{x}=\frac{U_{1}}{m}\left(\cos\phi\cos\psi\sin\theta+\sin\phi\sin\psi\right)\\
		&\ddot{y}=\frac{U_{1}}{m}\left(\cos\phi\sin\psi\sin\theta-\cos\psi\sin\phi\right)\\
		&\ddot{z}=\frac{U_{1}}{m}\left(\cos\phi\cos\theta\right)-g\\
		&\dot{\phi}={\omega}_x+\tan\theta\left({\omega}_y\sin\phi+{\omega}_z\cos\phi\right)\\
		&\dot{\theta}={\omega}_y\cos\phi-{\omega}_z\sin\phi\\
		&\dot{\psi}=\frac{{\omega}_y\sin\phi+{\omega}_z\cos\phi}{\cos\theta}\\
		&\ddot{\phi}=\frac{(I_{y}-I_{z})\cdot \dot{\theta}\dot{\psi}+U_{2}}{I_{x}}\\
		&\ddot{\theta}=\frac{(I_{z}-I_{x})\cdot \dot{\phi}\dot{\psi}+U_{3}}{I_{y}}\\
		&\ddot{\psi}=\frac{(I_{x}-I_{y})\cdot \dot{\phi}\dot{\theta}+U_{4}}{I_{z}}\end{aligned}
	\right.
	\label{2-7}
\end{equation}
\subsection{四旋翼无人机绳系吊运系统的动力学模型}
在本文的吊装运输场景中，四旋翼无人机在满足自身飞行需求的同时，还会受到吊装载荷对其作用的拉力干扰，单无人机吊装载荷受力分析如图 \ref{2_2} 所示，其中$F$表示无人机的升力，$G$表示无人机自身的重力，$G_0$表示无人机自身的重力，$T$表示载荷对无人机产生的拉力，$\theta$表示系绳与垂直平面之间的夹角。
\begin{figure}[hbt!]
	\centering
	\includegraphics[width=21pc]{picture/2_2.png} 
	\caption{单无人机吊装载荷受力分析} \label{2_2}
\end{figure}

对于四旋翼无人机绳系吊运系统来说，在轨迹跟踪时其系绳并不一定总是保持绷直状态的，在无人机的高速移动中系绳上的张力可能为零。因此，本文建立四旋翼无人机绳系吊运系统的混合模型，考虑系绳上的张力不为零和张力为零这两种情况。

\subsubsection{系绳张力不为零时的动力学模型}

四旋翼无人机绳系吊运系统由载荷相对于地面坐标系的位置、载荷姿态和四旋翼飞行器的姿态来定义。当系绳拉紧时，该系统具有八个自由度，并存在四个自由度的欠驱动。四旋翼无人机和载荷的位置之间的关系为：

\begin{equation}
	\bm p_q\bm p_l-l\bm q
\end{equation}
其中$\bm p_q$、$\bm p_l$分别为四旋翼无人机和载荷的位置，$l$为系绳的长度，$\bm q$表示从四旋翼无人机质心指向载荷质心的单位向量。本文采用拉格朗日法来推导运动方程。系统的拉氏量 $\mathcal{L}:T\bar{Q}\to\mathbb{R}$ 定义为$\mathcal{L}=\mathcal{T}-\mathcal{U}$，其中$\mathcal{T}:TQ\to\mathbb{R}$和${\mathcal{U}}:Q\to\mathbb{R}$分别是机械系统的动能和势能，它们的定义如下：

\begin{equation}
\begin{aligned}
	\mathcal{T}=\frac{1}{2}&m_{q}\bm v_{q}\cdot \bm v_{q}+\frac{1}{2}m_{l}\bm v_{l}\cdot \bm v_{l}+\frac{1}{2}\langle\hat{\bm  \omega_q},\widehat{\bm J_{q}\bm  \omega_q}\rangle\\
	&\mathcal{U}=m_{q}g\bm e_{3}\cdot \bm x_{Q}+m_{l}g\bm e_{3}\cdot \bm x_{l}
\end{aligned}
	\label{2-9}
\end{equation}
其中$\bm v_q$、$\bm v_l$分别为无人机和载荷的速度，$m_q$、$m_l$分别为无人机和载荷的质量，$\langle\cdot,\cdot\rangle $表示内积，$\hat{.}$被定义为使得 $\hat{\bm x}\bm y=\bm x\times \bm y$对于所有$\bm x,\bm y\in\mathbb{R}^3$恒成立，$\omega_q$为四旋翼飞行器在机体坐标系下的角速度。在本文中，$\lambda_m(\cdot)$和 $\lambda_n(\cdot)$ 分别表示矩阵的最小和最大特征值。系统的动力学满足拉格朗日原理：
\begin{equation}
	\bm \delta\int_0^\tau\mathcal{L} dt+\int_0^\tau\left(\langle \bm W_1,\hat{\bm \tau}\rangle+\bm W_2\cdot f\bm{R}_{b-e}\bm e_3\right) dt=0
	\label{2-10}
\end{equation}
其中$\bm W_{1}=\bm R_{b-e}^\mathrm{T}\bm \delta \bm R_{b-e}$是定义在旋转空间上的变分向量场， $ \bm W_{2}=\bm \delta \bm x_{Q}=\bm \delta \bm x_{L}-l\bm \delta q$是定义在平移空间上的变分向量场，两者共同描述刚体系统中的变分动态，并且满足以下条件：
\begin{equation}
	\begin{aligned}
	&\bm \delta \bm q = \bm \xi \times \bm q\\
	\bm \delta \dot{\bm q} = &\dot{\bm \xi} \times \bm q + \bm \xi \times \dot{\bm q} \\
	\bm \delta\bm  R&_{b-e} = \bm R_{b-e} \hat{\bm \eta} \\
	\bm \delta \hat{\bm  \omega _q}& = \widehat{\hat{\bm  \omega_q} \bm \eta} + \hat{\dot{\bm \eta}}
\end{aligned}
\end{equation}
其中$\bm \delta \bm q$为二维球面上的变分，$\bm \delta \bm R$为三维空间上的变分。
向量 $\bm{\xi} \in \mathbb{R}^3$ 是一个三维实数向量，满足 $\bm{\xi}$ 与向量 $\bm{q}$ 的点积为零，即$\bm{\xi}$ 垂直于 $\bm{q}$，向量 $\bm{\eta} \in \mathbb{R}^3$ 是一个三维实数向量。

由于(\ref{2-10})对所有可能的变化都是满足的，因此得到带有系绳载荷的四旋翼无人机的运动方程为：

\begin{equation}
	\begin{aligned}
		&\dot{\bm x}_{l}=\bm v_{l} \\
		(m_q+m_l)(\dot{\bm v}_L+g\bm e_3)& =(\bm q\cdot f\bm R\bm e_3-m_Ql(\dot{\bm q}\cdot\dot{\bm q}))\bm q \\
		&\dot{\bm q}=\bm \omega_l\times \bm q \\
		m_{q}l \dot{\bm \omega_l}&=-\bm q\times f\bm R\bm e_{3} \\
		&\dot{\bm R_{b-e}}=\bm R_{b-e}\hat{\bm  \omega_q} \\
		\bm J_{q}\dot{\bm  \omega_q}+&\bm  \omega_q\times \bm J_{q}\bm  \omega_q=\bm \tau
	\end{aligned}
\end{equation}

上述动力学可以写成标准形式 $\dot{\bm X}_n=\bm f_n(\bm X_n)+\bm g_n(\bm X_n)\bm u$ ，其中 $\bm X_n = \{\bm x_l,\bm q,\bm R_{b-e},\bm v_l,\bm \omega_l,\bm \omega_q\}$ 是系统的状态，$\bm u = \left[f,\bm \tau \right]$是系统的输入。
\subsubsection{系绳张力为零时的动力学模型}
当系绳张力趋于零时，四旋翼飞行器和吊挂载荷作为独立系统，载荷处于自由落体状态。在这种情况下，四旋翼无人机绳系吊运系统的运动方程为：
\begin{equation}
	\begin{aligned}
	&\dot{\bm x}_{l}=\bm v_{l}\\
	\quad m_{l}(&\dot{\bm v}_{l}+g\bm e_{3})=0\\
	&\dot{\bm x}_{q}=\bm v_{q}\\
	\quad m_{q}(\dot{\bm v}_{q}&+g\bm e_{3})=f\bm R_{b-e}\bm e_{3}\\
	&\dot{\bm R_{b-e}}=\bm R_{b-e}\hat{\Omega}\\
	\quad \bm J_{q}\dot{\bm \Omega}+&\bm \Omega\times \bm J_{q}\bm \Omega=\bm \tau
\end{aligned}
\end{equation}
上述方程也可以写成标准形式$\dot{\bm X}_z=\bm f_z(\bm X_z)+\bm g_z(\bm X_z)\bm u$，其中中$\bm X_z = \{\bm x_L,\bm x_q,\bm R_{b-e},\bm v_l,\bm v_q,\bm \omega_b\}$为状态。

\subsubsection{混合系统的动力学模型}
系绳悬挂载荷的四旋翼飞行器是一个混合系统，因为当缆索中的张力降为零或当张力恢复时松弛的缆索变得绷紧时，动力学会发生切换。混合模型可以写成，
\begin{equation}
	\left.\begin{aligned}&\Sigma_{n}:\left\{\begin{array}{ll}\dot{\bm X_n}=\bm f_n(\bm X_n)+\bm g_n(\bm X_n)\bm u  &\bm X_n\notin \mathbb{S}_z\\\bm X_z^+=\Delta_{n\to z}(\bm X_n^-)  &\bm X_n\in \mathbb{S}_z\end{array}\right.\\&\Sigma_{z}:\left\{\begin{array}{ll}\dot{\bm X_z}=\bm f_z(\bm X_z)+\bm g_z(\bm X_z)\bm u \ \ &\bm X_z\notin \mathbb{S}_n\\\bm X_n^+=\Delta_{z\to n}(\bm X_z^-) \ &\bm X_z\in \mathbb{S}_n\end{array}\right.\end{aligned}\right.
\end{equation}
其中集合$\mathbb S_z = \{ \bm X_n \mid  T \equiv 0 \}$，$\mathbb S_n = \{ \bm X_z \mid \|\bm x_Q - \bm x_L\| \equiv l, d \|\bm x_Q - \bm x_L\| /dt> 0 \}$，系绳上的张力定义为$T = \|m_L (\ddot{\bm x}_L + g\bm{e}_3)\|$，状态转移映射$\Delta_{n\to z}$为单位映射，$\Delta_{z\to n}$为两个物体非弹性碰撞的模拟，并满足条件$\dot{\bm x}_Q^+-\dot{\bm x}_L^+=0$。

\section{多无人机绳系吊运系统的动力学模型}
由于单个无人机的承载能力有限，提出了多无人机协同吊装运输方案，显著提升系统的承载能力。当无人机数量$n\geq3$时，多架无人机可以协同对载荷进行精准控制。本文研究由三架规格型号相同的四旋翼无人机协同运输吊挂负载的问题。该吊运系统
由三个四旋翼无人机、三根系绳和需要被运输的载荷组成。三个四旋翼无人机协同吊装运输载荷的飞行系统示意图如图 \ref{2_3} 所示，每个四旋翼无人机用
$q1$，$q2$，$q3$ 表示，吊挂负载用$p$表示，三架无人机保持水平高度一致，无人机之间的相对距离为$d$。

\begin{figure}[hbt!]
	\centering
	\includegraphics[width=28pc]{picture/2_3.png} 
	\caption{多无人机吊运系统} \label{2_3}
\end{figure}

在推导多无人机绳系吊运系统的动力学模型之前，先做了如下假设：



(1)无人机绳系吊运系统所吊挂的载荷被视为刚体； 


(2)连接无人机与有效载荷之间的系绳没有质量，且不会发生缠绕；

(3)所有系绳都连接在无人机的质心处，系绳的牵引力能够影响无人机的平
动，但是不影响无人机的转动。 

基于上述假设，本小节将建立多无人机绳系吊运系统的动力学模型。


在地面坐标系下，载荷位置向量为$p_{l}=[p_{lx},p_{ly},p_{lz}]^{\mathrm{T}}$，三个无人机的位置向
量分别用$p_{q1}$、$p_{q2}$、$p_{q3}$来表示，吊绳长度为$L$。对悬吊的载荷进行受力分析，由牛顿第二定律可得出：
\begin{equation}
	\begin{aligned}
		&f_{Li}=\frac{1}{L}(p_{qi}-p_{l})T_{i} \\
		&m_{1}\ddot{p}_{1}=-m_{1}ge_{3}+\sum_{i=1}^{3}f_{Li}
	\end{aligned}
\end{equation}
其中$f_{Li}$表示第i根绳子在惯性坐标系下所提供的拉力向量；$T_{i}$表示第$i$根绳子提供的拉力值标量。

对于系统来说，$\alpha_{i}$和$\beta_i$分别描述了系绳在地面坐标系 下相对于吊挂载荷的偏角，从载荷
质心到无人机质心的单位方向向量为：
\begin{equation}
	\boldsymbol{q}_i=\left[\cos\alpha_i\cos\beta_i,\sin\alpha_i\cos\beta_i\,\sin\beta_i\right]^\mathrm T
\end{equation}

默认在实际过程中吊挂负载始终位于三架四旋翼无人机之间，$\alpha_{i}$和$\beta_i$满足条件：
$0^\circ\leq\alpha_i\leq360^\circ$，$0^\circ\leq\beta_i\leq90^\circ$，再考虑到各个无人机在飞行中可能碰撞的情况，实际的$\beta_i$应该处在一个更小的合理范围内。

类似(2-5)，确定吊挂载荷的位置后，可以确定三架无人机的位置：
\begin{equation}
\begin{aligned}
	\boldsymbol{p}_{l}=&\left[p_{l_{x}},p_{l_{y}},p_{l_{z}}\right]^{\mathrm{T}} \\
	\boldsymbol{p}_{q1}&=\boldsymbol{p}_l+l\boldsymbol{q}_1 \\
	\boldsymbol{p}_{q2}&=\boldsymbol{p}_{l}+l\boldsymbol{q}_{2} \\
	\boldsymbol{p}_{q3}&=\boldsymbol{p}_l+l\boldsymbol{q}_3
\end{aligned}
\end{equation}
上式中，$\bm{p}_{q1}$，$\bm{p}_{q2}$，$\bm{p}_{q3}$和$\bm{p}_l$分别表示三个无人机和吊挂载荷的位置，$l$是系
绳长度。

与前文类似，无人机的控制输入为$\bm{U}=\left[U_1,U_2,U_3,U_4\right]^\mathrm{T}=\left[f_i,\tau_{x_i},\tau_{y_i},\tau_{z_i}\right]^\mathrm{T}$，其中$f_{i}$，$\tau_{x_i}$，$\tau_{y_i}$，$\tau_{z_i}$表示第 $i$ 个无人机的控制力和控制力矩大小，具体表述参
考式(\ref{2-5})和(\ref{2-6})。
同时，为了模拟系统受到的未知扰动（四旋翼无人机的诱导气流等），考虑有一个直接作用在吊挂载荷上的外界干扰力${\boldsymbol{f}}_{w}=\left[F_{xw},F_{yw},F_{zw}\right]^\mathrm{T}$。

在三个绳系四旋翼无人机吊挂负载系统中，存在三个非零张力系绳产生的完整约束，不考虑负载的刚体转动情况下，整个系统自由度为18（6×3+3-3）。本文为方便后续多机吊挂研究，选择吊挂负载的位置，三个无人机的姿态角以及三根系绳与吊挂负载形成的偏离角度作为系统的广义坐标，记作：
$$\boldsymbol{X}_n=
\left[
	p_{l_x} , p_{l_y} , p_{l_z},\alpha_1,\beta_1,\phi_1,\theta_1,\psi_1,\alpha_2,\beta_2,\phi_2,\theta_2,\psi_2,\alpha_3,\beta_3,\phi_3,\theta_3,\psi_3
\right]^\mathrm T$$

类似式(\ref{2-9})，三个无人机吊挂负载系统的动能和势能可分别表示如下：
\begin{equation}
	\begin{aligned}
	\mathcal{T}=\frac{1}{2}m_{l}{\boldsymbol{v}}_{l}^\mathrm{T}{\boldsymbol{v}}_{l}+&\frac{1}{2}\left[\sum_{i=1}^{3}\left(m_{q_{i}}\dot{\boldsymbol{v}}_{q_{i}}^{T}\dot{\boldsymbol{v}}_{q_{i}}+\boldsymbol{\omega}_{q_{i}}^{T}\boldsymbol{J}_{q_{i}}\boldsymbol{\omega}_{q_{i}}\right)\right] \\
	\mathcal{U}=\sum_{i=1}^{3}&m_{q_{i}}g\boldsymbol{e}_3\cdot\boldsymbol{x}_{q_{i}}+m_{l}g\boldsymbol{e}_3\cdot\boldsymbol{x}_{l}
\end{aligned}
\label{2-18}
\end{equation}
其中，$m_{q_{i}}$,$m_l$ 表示第 $i$ 个无人机和吊挂载荷的质量，

$\boldsymbol{J}_{q_{i}}$ 为无人机的转动惯量。
可以得到系统的欧拉-朗格朗日方程为:
\begin{equation}
\begin{aligned}
	&\mathcal{L}=\mathcal{T}-\mathcal{U} \\
	\boldsymbol{F}_{\boldsymbol{X}_n}=&\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial\mathcal{L}}{\partial\dot{\boldsymbol{X}_n}}\right)-\frac{\partial\mathcal{L}}{\partial\boldsymbol{X}_n}
\end{aligned}
\label{2-19}
\end{equation}


把式(\ref{2-18})代入式(\ref{2-19})中可得到如下二阶非线性微分方程：
\begin{equation}	
	\dot{\bm X}_n=\bm f_n(\bm X_n)+\bm g_n(\bm X_n)\bm u+\bm k_{n}\left(\bm f_{w}\right)
\end{equation}
其中$\bm k_{z}\left(\bm F_{p}\right)$为未知的外部干扰。
进一步选择状态向量为：$$\bm X=\left[x_{p},x_{p},y_{p},y_{p},z_{p},z_{p},\alpha_{i},\dot{\alpha}_{i},\beta_{i},\dot{\beta}_{i},\phi_{i},\dot{\phi}_{i},\theta_{i},\dot{\theta}_{i},\psi_{i},\dot{\psi}_{i}\right]^\mathrm{T}$$
记$\bm{U}=\left[f_i,\tau_{x_i},\tau_{y_i},\tau_{z_i}\right]^\mathrm{T}$作为控制力、力矩向量，${\boldsymbol{U}}_{w}=\left[F_{xw},F_{yw},F_{zw}\right]^\mathrm{T}$为外部干扰输入，从而把式(2-24)转换为一阶非线性微分方程：
\begin{equation}
	\dot{\boldsymbol{X}}=\bm f\left(\boldsymbol{X},\boldsymbol{U}\right)+\bm f_w\left(\boldsymbol{U}_w\right)
	\label{2-21}
\end{equation}

式(\ref{2-21})可以完整地描述出三个四旋翼无人机运输吊挂负载的动力学模型，而且当无
人机数量增加时，只需在状态变量中相应增加系绳偏角α、β即可。但是在实际运输控制中，无人机的控制器很难获取系绳偏角和吊挂载荷的位置信息，依照现有模型无法进
行控制器设计，因
此需要一个不包含载荷信息的简化模型，可以将系绳拉力可以被当作对无人机平动运动
的一个干扰力，绳子牵引力作用下的第$i$架无人机动力学模型为： 
\begin{equation}
	\left\{
	\begin{aligned}
		&\ddot{x}=\frac{U_{1i}\left(\cos\phi_i\cos\psi_i\sin\theta_i+\sin\phi_i\sin\psi_i\right)-f_{xi}}{m}+d_{xi}\\
		&\ddot{y}=\frac{U_{1i}\left(\cos\phi_i\sin\psi_i\sin\theta_i-\cos\psi_i\sin\phi_i\right)-f_{yi}}{m}+d_{yi}\\
		&\ddot{z}=\frac{U_{1i}\cos\phi_i\cos\theta_i-f_{zi}}{m}-g+d_{zi}\\
		&\ddot{\phi}=\frac{(I_{y}-I_{z})\cdot \dot{\theta}_i\dot{\psi}_i+U_{2i}}{I_{x}}\\
		&\ddot{\theta}=\frac{(I_{z}-I_{x})\cdot \dot{\phi}_i\dot{\psi}_i+U_{3i}}{I_{y}}\\
		&\ddot{\psi}=\frac{(I_{x}-I_{y})\cdot \dot{\phi}_i\dot{\theta}_i+U_{4i}}{I_{z}}\end{aligned}
	\right.
	\label{2-22}
\end{equation}
其中为$\boldsymbol{f}_{i}=
\left[f_{xi} , f_{yi} , f_{zi}\right]^\mathrm{T}$系绳拉力，$\bm d_i=\left[d_{xi},d_{yi},d_{zi}\right]^T$为系统受到的未知干扰，其中包括未知风扰等。 

式(\ref{2-22})表示了对各个无人机而言的简化模型，可以看出，式(\ref{2-22})中不包含载荷信息和其他无人机的状态耦合，而是用一个位置干扰力$\boldsymbol{d}_{i}$来表示。



\section{本章总结}

\cleardoublepage

\chapter{单无人机吊运控制}
\chaptermark{单无人机吊运控制}

许多学者都关注了单个无人机的控制问题，但是对于单个无人机搬运的控制问题，尤其是高精度跟踪控制问题比较难处理，再加上本文还有无人机搬运的载荷也会对无人机产生影响，所以本章考虑对载荷的精确位置跟踪控制问题。本章的任务是对无人机设计控制器，使得载荷能够跟踪指定的参考路径运动。 

本文把载荷当成一种干扰，首先用干扰观测器把载荷对无人机外环和内环的影响估计出来，然后在所设计的控制器中将该干扰进行补偿，这样所设计的控制器可以消除干扰对系统的影响，从而提高无人机搬运载荷的控制精度。

\section{问题描述}
在第 2 章中，我们介绍了单无人机绳系吊运系统的动力学模型，并建立了系绳上张力为零和不为零这两种情况组成的混合模型，该模型需要考虑两种情况之间的切换过程，然而对于控制器来说，载荷的状态信息是难以直接进行获取的。因此，本章采用数据驱动的方法，将动力学模型表达式(2-26)改写成如下形式：
\begin{equation}
	\begin{aligned}
		\dot{\boldsymbol{p}}_e = \boldsymbol{v}_e, \
		\dot{\boldsymbol{v}}_e = m^{-1}\left(-mg\bm{e}_3+\boldsymbol{R}_{b-e}f\bm{e}_3+\bm{f}_p+\bm{f}_{\text{res}}\right) \\
		\dot{\bm{R}_{b-e}} = \bm{R}_{b-e} \bm{\omega}_b^{\times}, \
		\dot{\boldsymbol{\omega}}_b = \boldsymbol{J}^{-1}\left(-\bm{\omega}_b^{\times}\bm{J} \bm{\omega}_b+\boldsymbol{\tau}+ \bm{\tau}_p+ \bm{\tau}_{\text{res}}\right)
	\end{aligned}\label{3-1}
\end{equation}



其中，$\bm{f}_p$和$\bm{\tau}_p$分别为有效载荷作用在无人机上的力和扭矩，$\bm{f}_\text{res}$和$\bm{\tau}_\text{res}$分别为无人机自身产生的残余力和扭矩。
为完整起见，我们将无人机受到的有效载荷和残余力叠加到一起，当作未知的非线性项即$\bm f_e = \bm f_p+ \bm f_{\text{res}}$ 和 $\bm \tau_e = \bm \tau_p+\bm \tau_{\text{res}}$ 。
	
该动力学模型中，非线性项$\bm f_e$和$\bm \tau_e$都是动态时变函数，其与无人机和吊挂载荷的运动状态高度耦合。本章需要解决问题是使用基于数据驱动的方法学习单无人机绳系吊运系统未知的系绳和载荷模型，然后将学习到的模型用非线性项进行表示，并集成到控制器中，实现无人机对期望轨迹的准确跟踪。 




\section{Koopman算子理论}

Koopman算子理论是一种用于分析和控制非线性动力系统的强大工具。该理论的核心思想是通过将非线性系统的状态空间映射到一个更高维的线性空间，从而将非线性系统转化为线性系统进行分析和控制。具体来说，Koopman算子理论通过引入一组称为“可观测量”的函数，将原始系统的非线性状态映射到一个线性状态空间中，从而使得原本复杂的非线性系统可以用线性系统的方法进行处理。
Koopman算子理论的提出为建模方法以及模型线性化方法提供了新的思路，本章中基于数据驱动的方法使用了Koopman算子理论的思想，因此，在本小节先对Koopman算子理论进行一个简单的介绍。

\subsection{经典Koopman算子理论}

考虑一个离散时间动力系统，其状态向量 \( x \in \mathcal{X} \subseteq \mathbb{R}^{N_x} \)。系统的传播规则由非线性函数 \( T \) 表示（如图 \ref{3_1} 所示）。通过使用可观测函数 \( x \mapsto g(x) \) 将原始状态 \( x \) 提升到新的空间，系统的动力学可以在一个新空间中重新定义，其中线性算子，称为Koopman算子 \( \mathcal{K} \)，描述了系统的动力学。换句话说，尽管 \( T \) 和 \( \mathcal{K} \) 作用在不同的空间上，但它们封装了相同的动态特性。例如，给定当前状态 \( x \)，可以通过两种途径将其传播到下一个时间步并进行观测：要么使用 \( T \) 计算 \( T(x) \) 并观测结果状态（底部路径），要么使用可观测函数，应用 \( \mathcal{K} \) 并在 \( x \) 处进行评估（顶部路径）。这种“等价”或“替代”概念提供了几个优势：

(1)它使得非线性动力学 \( T \) 能够全局线性表示，从而使得适用于线性系统的方法得以应用。

(2)它通过实时学习线性算子来估计底层动力学，从而消除了对非线性函数进行最小二乘回归的需求，这在一般情况下需要大量数据。
\begin{figure}[hbt!]
	\centering
	\includegraphics[width=34pc]{picture/3_1.png} 
	\caption{Koopman算子理论} \label{3_1}
\end{figure}
\subsection{基于Koopman理论的数据驱动预测}

考虑一个离散时间的动力学系统：
\begin{equation}
	x_{t+1} = T(x_t)\label{3-2}
\end{equation}

考虑一个复值函数（称为可观测量）的向量空间 \( \mathcal{F} \)，其定义域为系统的状态空间。可以将可观测量 \( g \in \mathcal{F} \) 视为映射或提升的状态。使用与式(\ref{3-2})相关的Koopman算子 \( \mathcal{K}: \mathcal{F} \to \mathcal{F} \) 对可观测量 \( g \) 的演化表示为：
\begin{equation}
	\mathcal{K}g = g \circ T, \quad \forall g \in \mathcal{F}
	\label{3-3}
\end{equation}
其中 \( \circ \) 表示函数复合。为了确保 \( \mathcal{K} \) 是良定义的， \( \mathcal{F} \) 必须在 \( T \) 的复合下封闭。如果 \( \mathcal{F} \) 包含特定的预定义函数（如返回完整状态值的函数），这一条件可能迫使 \( \mathcal{F} \) 成为无限维的。Koopman算子根据以下规则将系统向前传播一步：
\begin{equation}
	\mathcal{K}g(x_t) = g \circ T(x_t) = g(T(x_t)) = g(x_{t+1})
	\label{3-4}
\end{equation}

提升状态 \( g(x) \) 本质上将原始（非线性）系统转化为在Koopman空间中演化的线性系统，从而可以设计和实现各种线性控制器（如LQR）。为了避免处理无限维空间，可以使用Koopman算子的有限维表示。因此，在Koopman算子下不变的有限维子空间 \( \mathcal{S} \subset \mathcal{F} \) 起着至关重要的作用。形式上，设 \( \mathcal{S} \subset \mathcal{F} \) 是一个有限维Koopman不变子空间，并将Koopman算子的作用限制在 \( \mathcal{S} \) 上，即 \( \mathcal{K} \rvert_\mathcal{S}: \mathcal{S} \to \mathcal{S} \)。由于 \( \mathcal{S} \) 是有限维的，给定其基，可以将其表示为矩阵。形式上，设 \( \Psi \) 是一个向量值函数，其元素构成 \( \mathcal{S} \) 的基，则存在一个矩阵 \( \mathcal{K} \in \mathbb{C}^{\text{dim}(\mathcal{S}) \times \text{dim}(\mathcal{S})} \)，使得：
\begin{equation}
	\mathcal{K}\Psi = \Psi \circ T = \mathcal{K}\Psi
	\label{3-5}
\end{equation}

结合(\ref{3-5})和(\ref{3-4})，可以得到系统轨迹的线性演化，从而使得(\ref{3-2})可以使用线性系统理论的方法，即：
\begin{equation}
	\Psi(x_{t+1}) = \mathcal{K}\Psi(x_t)\label{3-6}
\end{equation}

通过定义 \( z_t := \Psi(x_t) \)，(\ref{3-6})可以写成线性形式 \( z_{t+1} = \mathcal{K}z_t \)。如果空间 \( \mathcal{S} \) 包含状态可观测量 \( g_i(x) = x_i \)，其中 \( x_i \) 是状态 \( x \) 的第 \( i \) 个元素，则可以选择基 \( \Psi \) 使其包含 \( g_i \) 作为其元素。在这种情况下，提升的线性系统(\ref{3-6})捕获了原始非线性系统(\ref{3-2})的完整信息。此外，矩阵 \( \mathcal{K} \) 的特征分解允许识别Koopman特征函数和特征值。

通常，找到包含所有状态可观测量的精确有限维不变子空间是具有挑战性的（有时是不可能的）。一个流行的解决方法是近似。假设空间 \( F \) 配备了内积，给定任意空间 \( \mathcal{S} \)（不一定是Koopman算子下的不变空间），可以考虑算子 \( P_\mathcal{S} \mathcal{K}: \mathcal{F} \to \mathcal{F} \)，其中 \( P_\mathcal{S} \) 是 \( \mathcal{S} \) 上的正交投影算子。对于这个算子，空间 \( \mathcal{S} \) 是通过构造不变的。因此，可以将这个算子的作用限制在 \( \mathcal{S} \) 上，即 \( P_\mathcal{S} \mathcal{K} \rvert_\mathcal{S}: \mathcal{S} \to \mathcal{S} \)，并给定 \( \mathcal{S} \) 的基 \( \Psi \)，该算子承认矩阵表示：
\begin{equation}
	P_\mathcal{S} \mathcal{K}\Psi = \hat{\mathcal{K}}\Psi
	\label{3-7}
\end{equation}
其中 \( \hat{K} \in \mathbb{C}^{\text{dim}(\mathcal{S}) \times \text{dim}(\mathcal{S})} \)。在这种情况下，可以写出（4）的近似版本如下：
\begin{equation}
	\Psi(x_{t+1}) = [\mathcal{K}\Psi](x_t) \approx [P_\mathcal{S} K\Psi](x_t) = \hat{\mathcal{K}}\Psi(x_t)
	\label{3-8}
\end{equation}

通过定义 \( z_t := \Psi(x_t) \)，前述方程可以写成近似线性形式 \( z_{t+1} \approx \hat{\mathcal{K}}z_t \)，从而可以使用高效的线性方法来近似系统的行为。在实践中，通常可以访问系统的离散采样测量数据。这可以用于获得无限维Koopman算子的有限维近似矩阵以及这些基于Koopman的组件。

与标准状态空间模型不同，Koopman算子模型了由系统动力学 \( f \) 驱动的函数演化，并且其存在性对于前向完备系统是保证的。由于Koopman算子是作用在函数空间上的算子，因此它通常是无限维的，但关键在于即使动力学 \( f \) 是非线性的，Koopman算子仍然是线性的。因此，如果 \( \phi \) 是与特征值 \( \lambda \in \mathbb{C} \) 相关联的特征函数，则有 \( K\phi = \lambda\phi \)。由此可以看出，特征函数（或特征函数的线性组合）沿着非线性系统（5）的轨迹线性演化：
\begin{equation}
	\phi(x_{k+1}) = \phi(f(x_k)) = (K\phi)(x_k) = \lambda\phi(x_k)
\end{equation}

给定一组特征函数 \(\{\phi_i\}_{i=1}^{n_\phi}\)，任何位于这些特征函数张成的空间内的可观测量都可以分解为：
\begin{equation}
	\psi = \sum_i c_i(\psi)\phi_i
\end{equation}
其中 \( c_k(\psi) \) 称为 \( \psi \) 的Koopman模态。于是我们有：
\begin{equation}
	K\psi = \sum_i c_i(\psi)\lambda_i\phi_i
\end{equation}
其中 \( \lambda_i \) 表示 \( \phi_i \) 的特征值。

在后续内容中，下标 \( u \) 用于表示与带有控制输入的系统相对应的组成部分。给定一个带有控制输入的非线性动力学：
\begin{equation}
	x_{k+1} = f_u(x_k, u_k)
\end{equation}

Koopman算子可以以不同的方式定义。在本工作中，我们考虑了文献[22]中的框架。具体来说，记无限控制序列 \( u := \{u_k\}_{\infty}^{k=0} \in l(U) \)，其中 \( l(U) \) 表示所有控制序列的空间。增广状态为：
\begin{equation}
	\chi=\begin{bmatrix}x\\u\end{bmatrix}
\end{equation}

系统的动力学被增广为：
\begin{equation}
	F(\chi_k)=\begin{bmatrix}f_u(x_k,u_k(0))\\Su_k\end{bmatrix}
\end{equation}

其中 \( S \) 是左移算子，定义为 \( Su(i) := u(i + 1) \)，且 \( u(i) \) 是 \( u \) 的第 \( i \) 个元素的值。在这种设置下，\( u \) 可以被视为从索引 \( i \) 到实际输出 \( u_i \) 的序列映射。值得注意的是，这个动力系统是无限维的但自治的。因此，上述Koopman算子的定义可以直接应用，并且相应的特征函数假设由以下基函数字典张成：
\begin{equation}
	\{\phi_u(x, u)\}_{i=1}^{n_{\phi_u} + n_u} := \{\phi_{u,1}(x), \ldots, \phi_{u,n_{\phi_u}}(x), u(0)\}
\end{equation}

如果这个基函数字典的演化在系统动力学下是封闭的，那么我们有：
\begin{equation}
\begin{aligned}
	z_{k+1}=Az_k+&Bu_k(0)\\u_{k+1}(0)=&u_k(1)
\end{aligned}
\end{equation}
其中 \( z_k := [\phi_{u,1}(x_k), \ldots, \phi_{u,n_{\phi_u}}(x_k)] \)，且 \( A \) 和 \( B \) 捕获了Koopman算子。类似地，这些基函数张成的空间内的任何函数都可以通过Koopman模态恢复为：
\begin{equation}
	\psi_u(x, u(0)) = c_u^T \begin{bmatrix} z \\ u(0) \end{bmatrix}
\end{equation}
其中 \( c := [c_{u,1}, c_{u,2}, \ldots, c_{u,n_{\phi_u} + n_u}] \) 是Koopman模态的向量。特别地，我们对系统输出的恒等函数评估的Koopman模态感兴趣。假设我们有 \( n_y \) 个输出，第 \( i \) 个输出的评估为 \( I_{y,i}(y_k) := y_{k,i} \)。通过一些符号的滥用，输出评估的Koopman模态分解为：
\begin{equation}
	y_k = \begin{bmatrix} I_{y,1}(y_k) \\ I_{y,2}(y_k) \\ \vdots \\ I_{y,n_y}(y_k) \end{bmatrix} = \begin{bmatrix} c_{u,1}^T \\ c_{u,2}^T \\ \vdots \\ c_{u,n_y}^T \end{bmatrix} \begin{bmatrix} z \\ u(0) \end{bmatrix} := C_u \begin{bmatrix} z \\ u(0) \end{bmatrix}
\end{equation}
其中 \( C_u \) 堆叠了输出评估的Koopman模态。

总之，Koopman算子理论通过将非线性系统提升到更高维的线性空间，使得复杂的非线性控制问题可以用线性方法进行处理，从而为非线性系统的控制设计提供了一种有效的工具。

\section{模型预测控制方法}

本小节重点阐述模型预测控制（Model Predictive Control，简称MPC）的基本原理及其应用流程，结合鲁棒非线性控制方法和离散化建模，形成适用于四旋翼无人机系统的完整设计框架。从预测模型建立到代价函数设计，再到优化问题求解，MPC为复杂控制问题提供了一种系统化、灵活性强的解决方案。通过系统状态的预测、滚动优化与反馈修正的有机结合，MPC方法在应对系统非线性、不确定性和外部扰动方面表现出显著的优势。


模型预测控制的核心思想是利用系统的数学模型预测未来的动态行为，并通过在线求解优化问题生成控制输入。其主要特性包括：

(1)预测与滚动优化：通过预测系统在未来一段时间内的行为，寻找最优的控制输入序列；仅执行最优序列中的首个输入，并滚动更新预测区间。

(2) 反馈矫正：实时采集反馈信息，用于修正模型误差和外部扰动的影响。

(3)优化问题求解：将控制问题转化为约束优化问题，通过数值算法在线求解。


以一般形式的二阶非线性系统为例，其状态方程和输出方程为：
\begin{equation}
\begin{aligned}
	\dot{x} = f(x, u&)\\
	\quad y = g(x)&
\end{aligned}
 \label{3-19}
\end{equation}
其中，状态变量 $x \in \mathbb{R}^2$，输入变量 $u$，输出变量 $y \in \mathbb{R}^2$。以下按照参考轨迹生成、系统建模和迭代优化三个步骤对控制器设计流程展开说明。

\subsection{参考轨迹}
在实际应用中，控制系统并不总是追求状态快速收敛。例如在进行轨迹追踪任务中，过快的状态变化可能导致跟踪不收敛。类似PID、
滑模控制、反步法等经典控制方法难以实现对预先设计的追踪，而MPC控制方
法可以比较方便地实现这一点。因此，需要为系统设计合理的参考轨迹 $x_\text{ref}$ 和 $u_\text{ref}$ ，使得目标状态 $x_\text{ref}$ 满足以下动态方程：
\begin{equation}
	\dot{x}_\text{ref} = f(x_\text{ref}, u_\text{ref})
	\label{aa}
\end{equation}
参考轨迹的设计不仅依赖于系统动态特性，还需要综合考虑实际任务需求。

\subsection{名义系统建模}

为便于计算和预测，引入名义系统作为实际系统的线性化近似模型。名义系统亦称标称系统，是实际物理系统的近似描述模型，通常用于预测系统在未来一段时间内的动态行为。针对非线性系统，常以平衡点附近的线性化模型作为其近似表达形式，对非线性函数 $f(x, u)$ 进行泰勒展开得：
\begin{equation}
	\dot{x} = f(x_\text{ref}, u_\text{ref}) + A_\text{con} (x - x_\text{ref}) + B_\text{con} (u - u_\text{ref})
	\label{a}
\end{equation}
其中，矩阵 $A_\text{con}$ 和 $B_\text{con}$ 分别为系统的状态和输入的偏导数矩阵：
\begin{equation}
	A_\text{con} = \frac{\partial f(x, u)}{\partial x} \bigg|_{x = x_\text{ref}, u = u_\text{ref}}, \quad B_\text{con} = \frac{\partial f(x, u)}{\partial u} \bigg|_{x = x_\text{ref}, u = u_\text{ref}}
\end{equation}
定义误差变量 $\tilde{x} = x - x_\text{ref}$，$\tilde{u} = u - u_\text{ref}$，将公式(\ref{a})与公式(\ref{aa})相减，可以得到误差动态方程为：
\begin{equation}
	\dot{\tilde{x}} = A_\text{con} \tilde{x} + B_\text{con} \tilde{u}
\end{equation}

在嵌入式控制应用中，系统需离散化以适应数字控制器的计算能力。假设采样周期为 $T$，利用欧拉法对连续时间系统进行离散化处理得到：
\begin{equation}
	\tilde{x}(k+1) = A_\text{dis} \tilde{x}(k) + B_\text{dis} \tilde{u}(k)
\end{equation}
其中$	A_\text{dis} = I + T A_\text{con}$，$ \quad B_\text{dis} = T B_\text{con}$，$T$为采样周期。
进一步构造增广状态向量，令$\varrho(k|t)=\left[\tilde{x}(k|t),\tilde{u}(k-1|t)\right]^\mathrm{T}$，可以得到：
\begin{equation}
	\begin{aligned}\varrho(k+1|&t)=A\varrho(k|t)+B\Delta u(k|t)\\&\sigma(k|t)=C\varrho(k|t)\end{aligned}
\end{equation}
其中
$$A_0=\begin{bmatrix}A_{dis}&B_{dis}\\0&I\end{bmatrix},B_0=\begin{bmatrix}B_{dis}\\I\end{bmatrix},C_0=\begin{bmatrix}C_{dis}&0\end{bmatrix}$$

假设$N_p$为预测周期，$N_c$为控制周期，通过迭代扩展预测模型可得未来 $N_p$ 步的输出序列：
\begin{equation}
	Y=\psi\varrho(k|t)+\kappa\Delta U
\end{equation}
其中$$
\boldsymbol{Y} = 
\left[
	\boldsymbol{\sigma}(k+1|t) , \boldsymbol{\sigma}(k+2|t) , \boldsymbol{\sigma}(k+3|t) , \cdots , \boldsymbol{\sigma}(k+N_p|t)
\right]^\mathrm{T}$$
$$\boldsymbol{\Psi} = 
\left[
	\boldsymbol{C}_0\boldsymbol{A}_0 , \boldsymbol{C}_0\boldsymbol{A}_0^2 , \boldsymbol{C}_0\boldsymbol{A}_0^3 , \cdots , \boldsymbol{C}_0\boldsymbol{A}_0^{N_p}
\right]^\mathrm{T}$$
$$\boldsymbol{\Delta U} = 
\left[
	\Delta u(k|t) , \Delta u(k+1|t) , \Delta u(k+2|t) , \cdots , \Delta u(k+N_c-1|t)
\right]^\mathrm{T}$$
$$\left.\kappa=\left[\begin{array}{ccccc}{C_{0}B_{0}}&{0}&{0}&{\cdots}&{0}\\{C_{0}A_{0}B_{0}}&{C_{0}B_{0}}&{0}&{\cdots}&{0}\\{C_{0}A_{0}^{2}B_{0}}&{C_{0}A_{0}B_{0}}&{C_{0}B_{0}}&{\cdots}&{0}\\{\vdots}&{\vdots}&{\vdots}&{\ddots}&{0,}\\{C_{0}A_{0}^{Np-1}B_{0}}&{C_{0}A_{0}^{Np-2}B_{0}}&{C_{0}A_{0}^{Np-3}B_{0}}&{\cdots}&{C_{0}A_{0}^{Np-Nc}B_{0}}\\\end{array}\right.\right]$$


\subsection{迭代优化}
模型预测控制的核心在于将控制问题转化为优化问题，并利用先进的计算机技术进行实时求解。对于一般非线性系统 (\ref{3-19})，其代价函数通常定义为：
\begin{equation}
	J = (Y - Y_\text{ref})^T Q (Y - Y_\text{ref}) + \Delta U^T R \Delta U + \rho \epsilon^2
\end{equation}
其中 $Q$ 和 $R$ 分别为输出权重矩阵和输入权重矩阵，$\rho$ 为松弛因子。代价函数中的三项分别对应参考轨迹的跟踪性能、对控制输入量进行约束，以及通过松弛因子方便对优化问题的求解。

令 $E = \Psi \xi - Y_{\text{ref}}$，则有：
\begin{equation}
	\begin{aligned}
		Y - Y_{\text{ref}} &= \Psi \xi + \Theta \Delta U + E - \Theta \Delta U 
		\\&= E + \Theta \Delta U
	\end{aligned}
\end{equation}

通过进一步整理，优化问题最终可以将代价函数表示为具有标准形式的二次规划问题：
\begin{equation}
	J_0 = \frac{1}{2} X^T H X + f^T X
\end{equation}

结合约束条件，将优化问题转化为标准形式的二次规划问题：

\begin{equation}
\begin{aligned}
	&\operatorname*{minimize}_{\Delta U,\varepsilon}&& \frac{1}{2}x^{\mathrm{T}}Hx+f^{\mathrm{T}}x  \\
	&\text{subject to}&& \begin{aligned}&Ax\leq b\\
		&A_{eq}x=b_{eq}\end{aligned}  \\
	&&&lb\leq x\leq ub\
\end{aligned}
\label{3-30}
\end{equation}

模型预测控制就是求解形如公式(\ref{3-30})的优化问题来得到控制量,利用快速二次规划算法可在线计算最优控制输入。




\section{基于数据驱动的非线性模型预测控制器设计}
本节详细阐述了所提出框架的原理与实现方法。核心思想是将外力 $\bm{f}_e$ 和力矩 $\bm{\tau}_e$ 建模为动态系统，并通过数据学习其行为。具体来说，提出的框架借助由Koopman算子理论导出的升维线性系统（Lifted Linear System, LLS），以显式方式捕获外力和力矩的动态特性。

\subsection{升维线性系统}
Koopman算子可以从数据中将非线性系统通过数据映射为全局线性系统 \cite{Mamakoukas2023}。这一性质为显式捕获未知非线性动态（如公式(\ref{quadrotordynamics})中的$\bm f_e$和$\bm \tau_e$）提供了一种数据驱动的方法。因此，本文采用这一特性，通过数据驱动的方式学习$\bm f_e$和$\bm \tau_e$。

考虑一个具有控制输入的未知非线性动力学系统： \begin{equation} \dot{\bm{x}} = \bm{f}(\bm{x},\bm{u}) \label{nonlinear_input} \end{equation} 其中$\bm{x} \in \mathbb{R}^n$为系统状态，$\bm{u} \in \mathbb{R}^p$为控制输入。定义一组标量值函数$\bm{g}$作为升维函数，这些函数构成了一个无限维的Hilbert空间$\mathcal{H}$。假设这些升维函数可以表示为： \begin{equation} \bm{g}(\bm{x},\bm{u}) = \bm{\Phi}(\bm{x}) + \bm{L}\bm{u} \end{equation} 其中$\bm{L}$为常数矩阵。在假设控制输入$\bm{u}$ 不会在Hilbert空间 $\mathcal{H}$ 中演化的条件下，公式(\ref{nonlinear_input})中的非线性动力学系统可以重新表述为： \begin{equation} \bm{\Phi}(\bm{x}(t_0+t_s)) = \bm{\mathcal{K}} \bm{g}(\bm{x}(t_0), \bm{u}(t_0)) = \begin{bmatrix} \bm{A} & \bm{B} \end{bmatrix} \begin{bmatrix} \bm{\Phi}(\bm{x}) \ \bm{u} \end{bmatrix}
\label{3-21} \end{equation} 其中，$\bm{x}(t_0+t_s)=\bm{x}(t_0)+\int_{t_0}^{t_0+t_s}\bm{f}(\bm{x},\bm{u}){\mathrm{d}t}$，$t_s$ 为采样时间$t_s$。上述公式描述了升维函数$\bm{g}(\bm{x})$的前向时间演化。令$\bm{z}(t) \triangleq \bm{\Phi}(\bm{x}(t))$，可以将公式(\ref{3-21})改写为： \begin{equation} \bm{z}(t_0 + t_s) = \bm{A}\bm{z}(t_0) + \bm{B}\bm{u}(t_0) \label{lls} \end{equation} 这被称为未知非线性动力学系统 (\ref{nonlinear_input}) 的升维线性系统（Lifted Linear System, LLS）。

如果给定非线性系统(\ref{nonlinear_input})的一组数据序列 $\{(\bm{x}_1,\bm{u}_1),\cdots,(\bm{x}_{T-1},\bm{u}_{T-1}),(\bm{x}_T)\}$，则可以通过求解以下最小二乘优化问题来近似估计矩阵$\bm{A}$和$\bm{B}$：
\begin{equation}
	\bm{A},\bm{B} = \mathop{\arg\min\limits_{\bm{A},\bm{B}}} \Vert \bm{Z}_{2:T} - (\bm{A}\bm{Z}_{1:T-1}+\bm{B}\bm{U}_{1:T-1}) \Vert \label{LS_AB}
\end{equation} 
其中，$\bm{Z}_{1:T-1}= [ \bm{z}_1,\bm{z}_2,\cdots,\bm{z}_{T-1} ]^\mathrm{T}$，$\bm{Z}_{2:T}= [\bm{z}_2,\bm{z}_3,\cdots,\bm{z}_{T}]^\mathrm{T}$，$\bm{U}_{1:T-1}= [\bm{u}_1,\bm{u}_2,\cdots,\bm{u}_{T-1}]^\mathrm{T}$，$\bm{z}_i$ 表示对应于第 $i$ 个样本 $\bm{x}_i\ (i=1,2,\cdots,T)$ 的状态。当$\bm{Z}{1:T-1}$和$\bm{U}{1:T-1}$的序列长度$T$有限时，上述优化问题实际上对Koopman算子进行了有限维近似 \cite{Hao2024}。

公式(\ref{lls})是离散形式，因其由数据驱动推导得到。因此，根据式 (\ref{lls})，未知非线性系统 (\ref{nonlinear_input}) 的连续有限维近似形式可以表示为： 
\begin{equation}
	\left\{ \begin{array}{c}
		\dot{\bm{z}}=\bm{A_c}\bm{z}+\bm{B_c}\bm{u}\\
		\bm{x}=\bm{Cz}\\
	\end{array} \right. \label{lift_linear}
\end{equation}

其中$\bm{A_c}=\log(\bm{A})/t_s$， $\bm{B_c}=\bm{B}/(\int_{0}^{t_s}e^{\bm{A}t}\text{dt})$， $\bm{z} = \bm{\Phi}(\bm{x}):\mathbb{R}^n \rightarrow \mathbb{R}^K$， $K\gg n$, $\bm{u}\in \mathbb{R}^p$， $\bm{A_c} \in \mathbb{R}^{K\times K}$，  $\bm{B_c} \in \mathbb{R}^{K\times p}$, $\bm{C} \in \mathbb{R}^{n\times K}$，$t_s$为采样时间间隔。





\subsection{基于学习的未知外力和力矩捕获方案}
本节提出了一种数据驱动的基于学习的框架，用以捕捉外力 $\bm{f}_e$ 和力矩 $\bm{\tau}_e$ 的未知动态特性。假设外力和力矩的未知动力学系统可描述为以下形式：

\begin{equation}
	\dot{\bm \chi} = \bm{\xi}(\bm \chi,\bm \zeta) \label{dynamics}
\end{equation}
其中 $\bm \chi = [ \bm f_e, \bm \tau_e]^\mathrm{T}$，$\bm{\xi}$ 表示外力和扭矩的未知动态函数，$\bm{\zeta}$ 表示系统的控制输入，通常是四旋翼的状态或部分子状态。$\bm{\zeta}$ 的选择将在后续的实现部分讨论。

如上所述，类似于公式(\ref{dynamics})这样的未知非线性动力学可以通过有限维的升维线性系统(\ref{lift_linear})从数据中捕捉。然而，寻找合适的基函数 $\bm{\Phi}$ 并非易事。因此，本文提出使用深度神经网络（DNN）来近似构造有限维的基函数，其表示形式如下：
\begin{equation}
	\bm{\Phi}(\bm \chi;\bm{\theta}) = W^{L+1}\phi(W^L(...\phi(W^1 \bm \chi...)) \label{dnn}
\end{equation}
其中，$\bm{\theta} = \{W^1, ..., W^{L+1}\}$ 表示网络的权重参数，$\phi$ 是ReLU激活函数。使用深度神经网络的主要动机在于其在函数近似中的强大能力。
为了找到与Koopman算子相关联的基函数，通过最小化以下损失函数来进行训练：
\begin{equation}
	L = \beta_1 L_{\text{recons}} + \beta_2 L_{\text{forward}} + \beta_3 L_{\text{backward}}
\end{equation}
其中 $\beta_1$、$\beta_2$ 和 $\beta_3$ 是正的超参数，分别衡量三种损失函数的权重。三个损失函数 $L_{\text{recons}}$、$L_{\text{forward}}$ 和 $L_{\text{backward}}$ 定义如下：

\textbf{\romannumeral1) 重构损失 $L_{\text{recons}}$}: 非线性系统的状态应从Hilbert空间 $\mathcal{H}$ 中重构。重构损失函数 $L_{\text{recons}}$ 定义为：
\begin{equation}
	L_{\text{recons}}=\Vert \bm{f}_e(t) - \bm{C} \bm{z}(t) \Vert
\end{equation}

\textbf{\romannumeral2) 多步预测损失 $L_{\text{forward}}$ 和 $L_{\text{backward}}$}: 从带有基准控制器的四旋翼无人机系绳吊运系统中采样数据，构建包含 $s$ 条轨迹的数据集 $\{\bm{X}_i \in \mathbb{R}^{n\times m}, \bm{U}_i \in \mathbb{R}^{p \times m}, i=1,\cdots,s\}$。每条轨迹含有 $m$ 个时间步长的数据。训练所需的标签，即每个采样时刻的外力 $\bm{f}_e$ 和力矩 $\bm{\tau}_e$，由四旋翼动力学方程 (\ref{3-1}) 计算得出。

每个采样时刻的+状态可以表示为 $\bm{Z}_i = [\bm{z}_0^i,\cdots,\bm{z}_{m-1}^i]=[\bm{\Phi}(\bm{\chi_{0}}^i),\cdots,\bm{\Phi}(\bm{\chi}_{m-1}^i)]\in \mathbb{R}^{K\times m}$。
通过升维线性系统(\ref{lift_linear})，基于初始状态 $\bm{z}_0^i$ 进行时间前向和后向预测，得到的预测状态分别为$\hat{\bm{Z}}_i^{\text{forward}} = [\hat{\bm{z}}_0^i, \cdots, \hat{\bm{z}}_{m-1}^i]$ 和 $\hat{\bm{Z}}_i^{\text{backward}} = [\hat{\bm{z}}_0^i, \cdots, \hat{\bm{z}}_{m-1}^i]$。


前向和后向预测误差的损失函数定义为：
\begin{equation}
	\begin{aligned}
		L_{\text{forward}} = \sum_{i=1}^{k} \mu_1^{i} {\rm MSE}(\bm{Z_{i}},\hat{\bm{Z_{i}}}^{\text{forward}})  \\
		L_{\text{backward}} = \sum_{i=1}^{k} \mu_2^{i} {\rm MSE}(\bm{Z_{i}},\hat{\bm{Z_{i}}}^{\text{backward}})\label{L2}
	\end{aligned}
\end{equation}
其中 $\mu_1,\mu_2 \in(0,1)$ 为超参数，用于调整损失项的时间步长权重。损失函数(\ref{L2})专注于最小化向前和向后的多步预测误差，这有助于在更长的预测范围内更精确地预测状态。

\subsection{学习动力学的理论保证}
尽管学习得到的动力学模型能够很好地拟合外力与力矩的动态特性，但其预测结果可能存在发散的风险，进而导致外力和力矩估计误差较大。为确保学习动力学的预测误差在全局范围内可控，需要引入一种约束条件对预测误差进行界定。以下定理为学习动力学的预测误差提供了理论上的全局有界性保证。

\begin{theorem}\label{error_boundness}
	假设存在正数 $\alpha_{\bm{\chi}}$ 和 $\alpha_{\bm{\zeta}}$，使得 $\Vert \bm{\chi}(t_0+t_s)-\bm{\chi}(t_0)\Vert \le \alpha_{\bm{\chi}}$ 和 $\Vert \bm{\zeta}(t_0+t_s) - \bm{\zeta}(t_0) \Vert \le \alpha_{\bm{\zeta}}$ 成立，并且近似得到的Koopman算子 $\hat{\bm{\mathcal{K}}}$ 是稳定的，且与其相关的基函数满足Lipschitz常数 $L_{\bm{\Phi}}$，则学习得到的动力学的预测误差是全局有界的。
\end{theorem}
\begin{proof}
	
在时刻 \( t_0 + n\Delta t \)，定义基函数在真实状态 \( s(t_0 + n\Delta t) \) 下的真实值为 
$
\Psi(s(t_0 + n\Delta t))$，
其近似解为$
\tilde{\Psi}_n
$，
其中 $ n \in \mathbb{Z}^+ $ 表示向未来推进的时间步数。

局部误差考虑的是模型在单个时间步长内的精度；全局误差考虑的是模型在所有时间步长内的精度。用$e_n$表示由近似的 Koopman 算子 \( \tilde{K}_d \)引起的第 
\( n \)个时间步的局部误差，其假设 Koopman 算子从前一个时间步开始传播基函数的真实值，即：
\begin{equation}
	e_n\equiv\Psi(s(t_0+n\Delta t))-\tilde{K}_d\Psi(s(t_0+(n-1)\Delta t))
	\label{k}
\end{equation}

其假设为 Koopman 算子可以将上一时间步的基函数真实值进行传播。此外，第 \( n \) 个时间步的全局误差记为 $E_n$。它假设Koopman算子从前一个时间步传播基函数的真实值。类似地，我们用$E_n$来表示第\( n \) 个时间步的全局误差：	
\begin{equation}
	E_n\equiv\Psi(s(t_0+n\Delta t))-\tilde{\mathcal{K}}_d^n\Psi(s(t_0))
	\label{kk}
\end{equation}


当 \( n = 1 \) 时，全局误差与局部误差（公式 (\ref{k})）相等。然而需要注意的是，全局误差（公式 (\ref{kk})）并不是局部误差（公式 (\ref{k})）的累积： 
$
E_n \neq \sum_{i=1}^n e_i
$。
我们在图 \ref{3_2} 中展示了局部误差与全局误差之间的区别。

	令$z(x)=\Psi(s(x))$，基于近似Koopman算子 $\hat{\bm{\mathcal{K}}}$ 的预测误差在经历 $n$ 个采样时刻后的全局误差可以表示为：
	\begin{equation}
		\bm{E}_n = \bm{z}(t_0 + nt_s) - \hat{\bm{\mathcal{K}}}^n \bm{z}(t_0)
	\end{equation}


	
	通过递归迭代(\ref{lls}), 全局预测误差可以表示为
	\[
	\begin{aligned}
		\Vert \bm{E_n} \Vert &= \Vert \bm{\Phi}(t_0+nt_s) -\hat{\bm{\mathcal{K}}}^n\bm{\Phi}(t_0) \Vert  \\
		&=\Vert \sum_{i=0}^{n-1}\hat{\bm{\mathcal{K}}}^i\bm{e}(t_0+(n-i)t_s)\Vert \\
		&\le \sum_{i=0}^{n-1}\Vert \hat{\bm{\mathcal{K}}}^i\Vert \cdot \Vert \bm{e}(t_0+(n-i)t_s) \Vert
	\end{aligned}
	\]
	其中，局部预测误差 $\bm{e}(t)=\bm{\hat{\chi}}(t)-\bm{\chi}(t)$，$\bm{\hat{\chi}}$ 表示外部力和力矩的预测值。
	
	由于 $\bm{\chi}$, $\bm{\zeta}$ 和基函数 $\bm{\Phi}$ 是Lipschitz连续的，根据文献\cite{Hao2024}的定理1，局部预测误差 $\bm{e}(t)$ 有界，即
	\[
	\begin{aligned}
		\lim_{n_h\rightarrow \infty} \text{sup} \Vert \bm{e}(t) \Vert &=(\Vert \bm{CA} \Vert L_{\bm{\Phi}}+1) \alpha_{\bm{\chi}}+\Vert \bm{CB}\Vert \alpha_{\bm{\zeta}} \\
		&+\max_{\overline{\bm{\chi}}\in \mathbb{B}} \Vert \overline{\bm{\chi}} -\bm{C}\bm{\Phi(\overline{\bm{\chi}}}) \Vert \triangleq c
	\end{aligned}
	\]
	其中，$n_h$ 是基函数中最后一个隐藏层的层数，$\mathbb{B}$ 是包含每个采样时刻 $\bm{\chi}$ 的集合。由于局部预测误差 $\bm{e}(t)$ 有界，且近似Koopman算子 $\hat{\bm{\mathcal{K}}}$ 稳定，因此
	\[
	\Vert \bm{E_n} \Vert \le \sum_{i=0}^{n-1}\Vert \hat{\bm{\mathcal{K}}}^i\Vert \cdot \Vert \bm{e}(t_0+(n-i)t_s) \Vert\le \Vert c \Vert \sum_{i=0}^{n-1}\Vert \bm{\mathcal{K}}^i \Vert
	\]
	是有界的。即预测误差有界。
\end{proof}


综上所述，上述定理表明，在满足特定条件下，学习的动力学模型的预测误差在全球范围内是有界的，从而保证了模型的稳定性与预测的准确性。
\begin{figure}[hbt!]
	\centering
	\includegraphics[width=30pc]{picture/3_2.png} 
	\caption{近似Koopman算子引起的局部误差和全局误差} \label{3_2}
\end{figure}
\subsection{基函数的Lipschitz常数约束}

如定理 \ref{error_boundness} 所述，如果基函数 $\bm{\Phi}$ 具有Lipschitz常数时，则预测误差是有界的。为了实现这一目标，用谱归一化（Spectral Normalization, SN）方法来约束基函数 $\bm{\Phi}$ 的Lipschitz常数。

根据定义，函数 $\rho$ 的Lipschitz常数等于其梯度的最大谱范数，即 $\Vert \rho \Vert_{\text{Lip}} = \sup \sigma (\nabla \rho)$。因此，对于由深度神经网络(\ref{dnn})参数化的基函数 $\bm{\Phi}$，可以通过限制每一层的谱范数来限定其Lipschitz常数。

线性层 $g(\bm{x})=\bm{W}\bm{x}$ 的Lipschitz常数为 $\Vert g \Vert_{\text{Lip}} = \sup \sigma(\nabla(g))=\sup \sigma(\bm{W})=\sigma(\bm{W})$。因此，基函数$\bm{\Phi}$的Lipschitz常数可以计算为（利用不等式 $\Vert g_1 \circ g_2 \Vert_{\text{Lip}} \le \Vert g_1 \Vert_{\text{Lip}}\cdot \Vert g_2 \Vert_{\text{Lip}}$）：

\[
\begin{aligned}
	\Vert \bm{\Phi}(\bm{\chi}) \Vert_{\text{Lip}} &\le \Vert g^{L+1} \Vert_{\text{Lip}} \cdot \Vert \phi_L \Vert_{\text{Lip}} \cdots \Vert \phi_1 \Vert_{\text{Lip}} \cdot \Vert g_1 \Vert_{\text{Lip}} \\
	&= \prod_{l=1}^{L+1}\sigma(\bm{W}^l)
\end{aligned}
\]
其中，ReLU激活函数的Lipschitz常数为1，即 $\Vert \phi_l \Vert_{\text{Lip}} = 1$。在训练过程中，对每一层的权重 $\bm{W}$ 进行谱归一化可以表示为：

\[
\hat{\bm{W}} = \bm{W} / \sigma(\bm{W}) \cdot \gamma ^{\frac{1}{L+1}}  \label{sn}
\]


\begin{lemma} \label{lemma_lip}
	通过对基函数应用谱归一化（\ref{sn}）方法之后，基函数的Lipschitz常数将满足以下约束：
	\[
	\Vert \bm{\Phi}(\bm{\chi}) \Vert_{\text{Lip}}\le \gamma
	\]
	其中，$\gamma$ 是基函数的目标Lipschitz常数。
\end{lemma}

\begin{proof}
	对DNN的每一层应用谱归一化之后，基函数的Lipschitz常数满足
	\[
	\Vert \bm{\Phi}(\bm{\chi}) \Vert_{\text{Lip}} \le \prod_{l=1}^{L+1}\sigma(\hat{\bm{W}}^l) = \prod_{l=1}^{L+1}\gamma^{\frac{1}{L+1}}=\gamma
	\]
	因此，通过谱归一化可以有效约束基函数的Lipschitz常数。
\end{proof}

综上所述，在深度神经网络的训练过程中，引入谱归一化技术不仅能够确保网络的Lipschitz常数满足特定的约束，还能提高模型的稳定性和泛化能力。这种方法在实现对嵌入函数约束的同时，避免了直接优化Lipschitz常数所带来的计算复杂性，从而为动态系统的学习提供了更加稳健的理论支撑。


\subsection{基于数据驱动下的学习动力学的控制器实现}

传统的鲁棒模型预测控制方法虽然能够有效应对系统中的不确定性，但其实际应用往往受到严格假设条件的限制，难以完全满足实际工程需求。此外，模型预测控制的闭环性能在很大程度上依赖于其内部模型的准确性，模型误差可能导致控制效果的下降。

为了解决这些问题，引入数据驱动预测模型的方法，利用其强大的数据拟合能力捕捉系统中难以建模或缺失的动态特性，从而显著提升控制器的整体性能和鲁棒性。
对于四旋翼无人机系绳吊运系统来说，使用基于Koopman理论的升维线性系统，对未知有效载荷和残余动力学引起的外力进行建模，捕获得到未知外力和力矩并集成到模型预测控制框架中，系统的模型以及状态和输入约束被考虑在如下形式的优化问题中：
\begin{equation}
	\begin{aligned} \label{nmpc}
		&\operatorname*{minimize}_{\bm{\bar{u}}}& & \sum_{i=0}^{N-1}\left(\bm{\bar{x}}_i^T\bm{Q}\bm{\bar{x}}_i + \bm{\bar{u}}_i^T\bm{R}\bm{\bar{u}}_i\right) + \bm{\bar{x}}_N^T\bm{P}\bm{\bar{x}}_N  \\
		&\text{subject to}& & \begin{aligned}
			&\bm{\bar{x}}_{0} = \bm{x}_k, \quad \bm{\bar{x}}_{N} \in \mathcal{X}_f, \\
			&\bm{\bar{x}}_{i+1} = \bm{f}_{\text{nominal}}(\bm{\bar{x}}_i, \bm{\bar{u}}_i) + \bm{f}_{\text{learned}},
		\end{aligned} \\
		&&& \bm{\bar{x}}_i \in \mathcal{X}, \quad \bm{\bar{u}}_i \in \mathcal{U}, \quad \forall i = 0, \ldots, N-1
	\end{aligned}
\end{equation}
其中，$\bm{x}_k$表示四旋翼在时间$k$时刻的状态，$\bm{\bar{x}}_i$和$\bm{\bar{u}}_i$分别是时间$k$的预测状态和控制输入，$N$是预测时域。$\mathcal{X}$、$\mathcal{U}$和$\mathcal{X}_f$分别是状态、控制输入和终端状态的约束集。$\bm{Q}$和$\bm{R}$是状态和控制输入的权重矩阵，$\bm{P}$是终端状态的权重矩阵。$\bm{f}_{\text{nominal}}$是四旋翼无人机的名义动力学，而$\bm{f}_{\text{learned}}$是通过升维线性系统学习得到的动态特性。

该优化问题通过序列二次规划（SQP）求解，并在实时迭代（RTI）方案中使用高斯-牛顿海森近似来提高计算效率。这种方法将学习到的动态特性融合到传统的名义模型里，从而提高控制器的性能和鲁棒性，整个算法的框架如图\ref{illustration_framework}所示，

\begin{figure}[hbt!]
	\centering
	\includegraphics[width=38pc]{picture/3_3.png} 
	\caption{数据驱动下的非线性模型预测控制框架} \label{illustration_framework}
\end{figure}
\section{仿真验证}


\section{本章总结}




\cleardoublepage

\chapter{多无人机吊运控制}
\chaptermark{多无人机吊运控制}




\cleardoublepage

\chapter{物理引擎仿真与试验验证}
\chaptermark{物理引擎仿真与试验验证}
%为验证所提出方法的可行性与有效性，本章对章动目标消旋地面实验系统进行了搭建。实验系统主要由目标章动旋转模拟装置、磁场源、机械臂和计算机组成，通过目标章动模拟装置模拟空间目标的章动旋转运动，通过机械臂抓取磁场源模拟服务星的运动。采用不同消旋轨迹进行了多组实验，记录目标角速度变化情况并对结果进行了比较分析。
为了验证上述提出方法的可行性与有效性，通过物理引擎仿真和试验验证两个方面对设计的算法效果进行评估。在物理引擎仿真方面，利用Gazebo、Drake和MuJoCo几种主流仿真平台，搭建四旋翼无人机绳系吊运系统的动力学和环境模型，并模拟其飞行轨迹与响应特性。在试验验证方面，基于实际硬件搭建四旋翼无人机绳系吊运系统，并在室内场景中完成一系列试验，验证仿真模型的准确性与适用性。本章通过仿真与试验的结合，为四旋翼无人机绳系吊运系统的设计与优化提供科学依据。
\section{物理引擎仿真系统介绍}

为实现对四旋翼无人机绳系吊运系统的深入分析和验证，选用了几种主流物理仿真平台，包括Gazebo、Drake和MuJoCo。这些平台具有高效的物理建模和仿真功能，可以满足复杂动力学系统建模及仿真精度的需求。本节将对仿真系统的构建流程、各平台的特点及其在仿真中的具体应用进行详细介绍。

\subsection{仿真平台的选型与特点}
Gazebo是一款广泛应用于机器人学领域的开源仿真工具，其优势在于支持复杂的三维环境建模和多传感器模拟。通过与Robot Operating System (ROS) 的集成，可以方便地实现机器人算法的验证和硬件交互仿真。对于四旋翼无人机仿真，Gazebo能够通过插件实现气动力、重力以及绳系约束的精确建模。

Gazebo 是一个非常常用的开源机器人仿真平台，尤其在与ROS集成方面非常出色，常用于工业级别的仿真研究。

学习难度：中等偏高。Gazebo 的学习曲线比 Webots 更陡，尤其是如果要结合ROS使用。不过，Gazebo 的灵活性和扩展性较好，可以支持复杂的仿真。
教程和资源丰富度：Gazebo 作为 ROS 生态的一部分，有非常多的教程、文档和社区支持。大量的在线资源和开源库可以为用户提供帮助，特别是与ROS相关的项目。
力控传感器支持：Gazebo 支持精确的物理仿真，可以仿真力/扭矩传感器等，且可以进行高保真的力控仿真。适合用于研究中对力控有较高要求的仿真项目。
优势：支持复杂的物理仿真，尤其在动态模拟和力控制方面的精度较高。强大的ROS集成能力适合与机器人相关的研究和开发。
不足：对于初学者而言，学习成本较高，配置和调试较为复杂。尤其是力控仿真，可能需要深入了解 Gazebo 的物理引擎（如 ODE 或 Bullet）及相关参数的调整。
	

MuJoCo以其高效的动力学计算和稳定的仿真性能而闻名，特别适用于高频实时控制场景。在四旋翼无人机仿真中，MuJoCo可用于快速评估系统在不同环境约束下的动态响应。其支持的柔性物体建模功能对绳系的模拟具有优势。

MuJoCo 是一个高性能的物理引擎，专注于多关节系统的动力学仿真，特别适合机器人和肌肉控制的研究。它以其快速精确的物理仿真能力而闻名。

学习难度：较高。MuJoCo 是专注于动力学和接触仿真的引擎，虽然功能强大，但对初学者的门槛较高，尤其是在使用其API或结合其他系统时。
教程和资源丰富度：相对较少。虽然 MuJoCo 的文档和一些示例相对齐全，但其社区规模较小，在线教程和用户讨论较少，学习资源不如 Gazebo 和 Webots 丰富。
力控传感器支持：MuJoCo 的物理仿真极为精确，能够非常准确地模拟力控场景，尤其在处理接触力、扭矩和关节动态方面表现出色。适合做高精度的力控仿真。
优势：物理仿真精度非常高，尤其适合复杂、多关节力控仿真。性能表现优异，特别是在处理接触和动力学仿真时。
不足：学习难度较大，文档和社区资源相对较少，适合有物理仿真和机器人动力学基础的研究者使用。与ROS的集成不如Gazebo顺畅。


\subsection{动力学与环境模型的构建}
在仿真平台中，首先对四旋翼无人机及其绳系吊运系统进行动力学建模，包括无人机主体的刚体模型、旋翼的气动力模型，以及绳系的柔性力学模型。接着，在环境建模中引入以下关键要素：

绳系的约束建模：模拟系绳在受力、摆动及碰撞等情况下的动力学行为。
外部环境扰动：包括风场、气流湍动等干扰因素，用以测试控制算法的鲁棒性。
目标物体：模拟无人机需吊运的目标物体，其质量、重心及几何特性对吊运系统的稳定性影响显著。
\subsection{仿真系统的功能验证与优化}
在完成模型构建后，通过对以下典型任务场景的仿真，验证系统的功能及性能：

轨迹跟踪：设定预定轨迹，测试无人机在不同载荷条件下的轨迹跟踪能力及控制精度。
抗干扰能力：施加随机扰动，评估无人机对环境变化的响应特性。
稳定性分析：在复杂任务环境中，模拟绳系摆动的动态特性，验证算法的适用性与稳定性。
通过对上述平台的综合使用和比对分析，仿真系统为后续试验验证及算法优化提供了可靠的基础和参考数据。

\subsection{低保真度Drake仿真引擎}
Drake 是麻省理工大学的计算机科学与人工智能实验室联合丰田研究院开发的一个强大的开源物理仿真和控制工具，专注于动力学建模、优化和精确控制仿真平台，用于分析机器人的动力学并为它们构建控制系统，尤其适合高自由度系统的研究。Drake 旨在模拟包括摩擦、接触、空气动力学等在内的机器人复杂动力学，并将这些信息提供给高级规划、控制和分析算法。与simulink相似，Drake 强调模块化设计，并提供灵活的接口和先进的数学工具，是学术研究和工业应用的理想选择。同时，其高效的优化工具可以辅助实现控制算法的验证与性能优化。

本节讨论尝试使用 Drake 验证四旋翼无人机绳系吊运系统中控制系统的稳定性
多无人机悬挂负载系统中控制系统稳定性的一些挑战。选择 Drake 是因为它是一个流行的开源工具箱，专注于接触力学仿真并提供许多预实现的控制器。



主要结果的视频概述可以在这里找到，而相应的代码可以在这里找到。请注意，视频清晰地展示了该项目的三个组成部分：差分平坦度、状态调节和轨迹稳定。这里仅讨论状态调节和轨迹稳定组件（如图 3.11 所示），因为微分平坦度模块主要由合作者开发。
Drake 工具箱提供了三个核心组件，用于实现高效、灵活的动力学系统建模：
(1)动力学系统建模
Drake 的核心功能是允许用户通过大量的动力学组件构建系统模型。这些组件包括传感器、执行器、估计器和控制器等模块，能够满足复杂系统建模的需求。

(2)多体运动学与动力学
Drake 支持多种运动学模型格式的解析，能够对多体系统进行运动学仿真，并支持接触建模。无论是刚体还是柔性体，Drake 都能提供精确的动力学计算。

(3)数学规划求解
提供了统一的接口，支持多个数学规划求解器。这使得 Drake 能够处理复杂的优化问题，包括路径规划、控制优化和系统稳定性分析。

在进行系统建模时，通常使用仿真描述格式（SDF）文件。SDF 文件结构化地描述了模型的各个部分，能够清晰地定义系统的动力学属性，如图 3.12 所示。在 Drake 中，SDF 文件是建模的主要工具之一，通过定义传感器、执行器和多体结构等实现精确的仿真建模。


该文件由 Drake 的多体运动学组件解释，给出如图 3.13 所示的系统。然后，该系统通过动力系统组件中的一些模块进行增强，包括螺旋桨和 LQR 控制器（第 3.4.2 节中讨论）。



\subsection{中保真度Gazebo仿真引擎}
尽管之前讨论的仿真器有各自的应用场景，但它们无法轻松模拟多无人机吊挂载荷的动力学和控制行为。一些专门的仿真器可以实现这一点，例如 RotorTM，但通常是为特定目的而构建的。为了准确测试视觉载荷姿态估计算法，需要一个能够生成视觉数据的仿真器。此外，仿真器生成的数据必须在真实动力学和控制场景的背景下，以保证与真实世界中观测到的视觉数据尽可能接近。这不仅可以确保在实际测试前验证整个系统的稳定性和安全性，还可以提高算法的转移能力。

本节介绍了一个基于开源工具构建的多无人机吊挂载荷仿真平台。该平台专为载荷状态估计算法设计，并着重于实现从仿真到真实户外场景的顺利过渡。用于修改 PX4 的 Gazebo 仿真模块以适配此平台的自定义模型可在 GitHub 链接 找到，相关仿真飞行的视频结果可在 YouTube 链接 中查看。附录 C 汇总了本文其余部分提到的所有测试视频结果，便于读者参考。

Gazebo 平台概述
Gazebo 是一个通用的开源仿真框架，它将刚体物理引擎（例如本文使用的开放动力学引擎 ODE）与图形用户界面（GUI）相结合，并提供大量插件用于仿真各种机器人组件（如电机、螺旋桨的空气动力、接触力学、刚体力学、传感器噪声和摄像头等）。类似于 Drake，Gazebo 能够接收以 SDF 文件定义的多体机器人（如图 3.16 所示），并与之进行动力学交互。

缆绳建模
由于 Gazebo 和许多其他机器人仿真器只能模拟刚体，因此柔性缆绳动力学需要通过多段刚体链接进行建模（如图 3.17 所示）。影响该缆绳模型精确度的五个关键参数包括：

链接数量：缆绳中包含的刚性圆柱体数量。更多的圆柱体能更接近真实缆绳，但会增加计算资源消耗。经验表明，使用 10 个链接可以在精度和计算资源之间实现平衡。
关节类型：选择哪种类型的关节（如球铰、滑动关节或万向节）。由于连续缆绳没有刚性关节，最优选项是约束最少的球铰。然而，考虑到阻尼系数对缆绳动力学的影响，实际使用的关节是万向节。
关节阻尼系数：描述关节运动中的能量损失速率。阻尼系数过大会减少能量传递，而阻尼系数过小则可能导致持续振荡甚至不稳定。研究表明，阻尼系数的最佳值为 0.01 N·s/m，这是允许的最小非零值。阻尼值低于此（即无阻尼）会导致振荡失控，而高于此则会削弱预期的运动传递效果。
该仿真平台结合了高效的动力学建模和视觉数据生成，适用于多无人机吊挂载荷系统的研究与验证。

\subsection{高保真度MuJoCo仿真引擎}

\section{无人机绳系吊运系统控制仿真验证}
\section{试验系统介绍}

试验系统主要分为硬件环境配置和软件环境配置两部分，硬件环境配置根据试验方案和算法需求，选择适配的机载设备型号，并配套选取合适的无人机机架、动力系统和电池容量。同时，设计和改装结构件以安装合作标识及机载计算设备，并配置用于测量真值的外部设备等，确保硬件的整体性能满足试验需求。软件环境配置为算法运行提供必要的软件支持，包括底层驱动支持与其他硬件设备的通信等。整体设计以硬件和软件的协同配合为核心，确保试验系统能够高效支持算法的开发与验证。
\subsection{硬件配置}
由于无人机吊运控制算法在实机测试中需要精确获取自身位置，而室外环境受地形复杂、信号干扰及气候条件等因素的限制，难以实现高精度的绝对位置测量。为此，试验选择在室内环境开展测试，采用光学定位系统进行无人机位置的测定。光学定位系统通过高精度相机阵列实时跟踪目标，能够提供亚毫米级的精确位置数据，具有抗干扰能力强、稳定性高的特点，为算法的验证和性能评估提供了可靠的参考基准。系统的硬件框架如图 \ref{framework} 所示。
\begin{figure}[hbt!]
	\centering
	\includegraphics[width=36pc]{picture/5_4.png} 
	\caption{室内试验系统硬件配置} \label{framework}
\end{figure}

光学定位系统选用Optitrack。Optitrack 使用复数摄像头从不同角度识别安装在待跟
54 
第5章  仿真与试验 
踪物体上的特殊反射球，并通过计算机视觉方法跟踪这些反射球在空间中的位置。通过
在刚体上安装4个非共面反射球的方法。Optitrack可以解算出刚体的位姿，并提供具有
亚毫米级精度[74]的高频实时位姿估计。 
地面站通过路由器提供的局域网，使用SSH连接到无人机的机载计算机上，发布指
令并监控无人机状态。同时，机载计算机也通过局域网与工作站建立连接，通过VRPN
协议获取室内定位数据。 
接下来确定无人机平台上主要的硬件设备型号。综合算力、重量和接口数量等因素，
试验平台选用如图5-2(a)所示的 NUC 作为机载计算设备（上位机）。NUC 上装载的 i7
芯片保证了强劲的CPU计算性能，且相比其他ARM平台，x86_64的架构拥有更好的
软件兼容性。此外，薄款的NUC整机高度不到40mm，且采用塑料外壳，重量较轻，可
以方便地装载到无人机平台上。在下位机的选择上，如图5-2(b)所示，平台选用基于PX4
开源项目的雷迅 CUAV V5+飞控作为下位机，负责底层的控制工作。V5+在 Pixhawk 
FMUv5标准上改进而来，选用速度更快的STM32F765芯片作为主处理器，并设计了冗
余的传感器组，能最大化保障飞行任务的执行。 
UWB模块选用空循环（Nooploop）的LinkTrack P模块，该模块工作在4GHz频段
附近，能提供高频的测距和数据通信功能，同时具有极低的工作功耗，如图5-2(c)所示。
LTP 被广泛应用于室内外的机器人导航、集群系统编队、测距防撞系统等场景中，受到
用户的广泛认可。机载相机模块选用4个全局快门CCD摄像头和FOV120°的广角镜
头组合，获取全向视野，使用720p的视频流以兼顾更新频率、解算精度和解算距离。

随后，对无人机平台的机械部分进行设计。无人机的机架决定了无人机能选装的最
大桨叶型号，从而决定了其载荷上限，因此在无人机方案设计中被第一个确定。本文选
择使用JMRRC 360机架，电机轴距为360mm，机臂和中心板采用双层碳板结构，中间
使用铝柱连接。这种设计常见于小型四旋翼的结构设计中，相比起使用碳管作为机臂的
方案，能省去碳管管夹（通常是铝制铣件）的重量，兼具轻便和强度。 
在确定了机架型号后，动力配置也随之确定。飞行平台选用T-Motor Air Gear 350动
力套件，包括4个2213 KV920的无刷电机、对应的20A电子调速器（Electronic Speed 
Controller，ESC）和 2 对 9545 自锁尼龙桨。官方建议无人机总重控制在1.2-1.5kg之间，
55 
西北工业大学硕士学位论文 
但在实测中发现，在不要求大幅度机动和长航时的情况下，可以做到2.2kg附近的满载
起飞，悬停油门约在60%附近。电池选用格氏ACE系列的4s1p 4000mAh 25C锂电池
组，相比3s电池，4s电池可以提供更强的动力，且4s电池可以直接给NUC供电，不
需要转接升压模块。续航方面，满载测试续航在8分钟附近，可以满足试验要求。最后，
对其他的安装件进行设计，包括NUC固定件、视觉合作标识和相机的安装件等。最终
的设计图和实物图如图5-3所示。 
Optitrack
反射球
UWB模块
CUAV V5+
合作标识
广角摄像头
(a)                                             
(b) 
图5-3 无人机平台设计图和实物图 
NUC
无人机的线路和信号关系并不复杂，图5-4中列出了无人机上主要原件的关系图，
注明了通信线上的通信内容或协议，并用虚线和实线区分了供电线和信号线：


\subsection{软件配置}
系绳收放机构的软件部分使用C语言编程，设计包括主程序和子程序部分。主程序
内初始化各个子模块，包括延时函数初始化、串口初始化、指示灯初始化以及定时器初
始化。子程序部分包括了定时器周期中断、张力传感器数据读取、伺服电机驱动和状态
反馈。当主程序完成各个子模块初始化后，便会循环进入定时器中断响应，一旦中断发
生，则立即响应中断请求执行相应任务。 
需要说明的是波特率是指每秒传送的字节数，读取张力传感器数据时串口的波特率
设置为9600，默认情况下驱动直流伺服电机时的波特率为57600。当主程序经过中断使
能后，定时器1ms中断一次，并以10ms的周期完成张力值读取、控制器运算和电机力
矩输出。为了检测程序实时运行情况，正常状态下板载LED灯每1s亮灭交替一次，如
发生程序堵塞，则LED灯出现状态异常。程序流程图如图5-12所示。 
60 
第5章  绳系无人机试验系统设计与试验验证 
中断开始
清除中断标志
10ms
N
Y
读取张力值
N
控制器计算
控制伺服电机
转矩
1s
Y
LED灯亮灭交替
中断返回
图5-12 系绳收放机构软件逻辑 
四旋翼控制代码程序由C++编写，板载计算机NUC与飞行控制器通过USB转串口
线相连，波特率为921600。主程序首先定义发送和接收数据类型，包括输出的推力和姿
态角、位置数据和以四元数表示的姿态数据。定时器以10ms的周期运行控制算法并将
运算结果交由飞行控制器执行。 



\section{绳系无人机协调规划控制试验验证}
\section{本章总结}


\cleardoublepage

\chapter{总结与展望}
\chaptermark{总结与展望}


\section{本文工作总结}


\section{未来工作展望}




%%=============================================================================%
%% 参考文献以及附录
%%-----------------------------------------------------------------------------%
\bibliographystyle{nputhesis}                               % GB/T 7714-2015 格式
%\bibliographystyle{nputhesis-noslash}                       % 参考文献改进格式
\bibliography{reference}                                    % 参考文献
%%=============================================================================%
%% 文档附页部分（致谢、参加科研情况、知识产权与原创性声明）
%%-----------------------------------------------------------------------------%
\backmatter                                                 % 文档附页部分
%%-----------------------------------------------------------------------------%
%\bibliography{ref}

\begin{acknowledgements}                                    % 致谢开始
时光如白驹过隙，转眼间我的研究生生活即将画上句号。在西北工业大学航天学院的三年求学岁月里，我不仅收获了专业知识，锻炼了科研能力，更收获了无数宝贵的友情和深厚的师生情谊。在此，我怀着感恩的心情，衷心感谢所有在我的成长过程中给予帮助、支持和鼓励的每一位老师、同学和家人。

首先，我要衷心感谢我的导师张帆教授。张老师严谨的治学态度和孜孜不倦的工作精神一直是我学习的榜样。作为我的导师，张老师不仅在学术上给予我无微不至的指导，还为我提供了优越的科研条件，并始终关心和支持我的成长。在张老师的教诲和引导下，我不断完善自己的专业技能，逐步迈向科研的高峰。在此，向张老师表达我最深的感激之情。

其次，我要感谢张帆老师，张老师的支持与鼓励在我的研究生生涯中占据了重要的位置。她不仅是我的学术导师，更像是我亲切的大姐姐。无论是在课题的设计、实施过程中，还是在面对困惑和挫折时，张帆老师始终给予我极大的关怀和帮助。她总是耐心地为我解答问题，鼓励我在科研上不断突破自我，从不因困难而气馁。我深深感激张帆老师对我个人成长的悉心帮助与关爱。


最深沉的感激，属于我的父母。感谢他们一直以来对我的无私支持和鼓励。无论是生活中的点滴关怀，还是学业上的悉心照顾，父母为我提供了坚强的后盾。正是因为他们的辛勤付出和无怨无悔的奉献，才让我能够在求学的道路上无所畏惧、勇往直前。父母的恩情，我将铭刻一生，终身难忘。

在学术和生活上，我还要感谢王通师兄、刘习尧师兄、刘亚师姐。感谢你们在我遇到学术难题时耐心的解答和指导。你们不仅帮助我解决了实验中的技术问题，也让我在学术研究中不断完善自我。还要特别感谢我的同门杨立、文思捷和师弟金澳，感谢你们在我的实验研究过程中提供的宝贵意见和支持，帮助我克服了诸多技术和设计难题。

此外，我的室友、老大哥粟刚，是我研究生期间的另一位重要人物。感谢你在我忙碌的学术生活中，给予我生活上的关心与支持。你的乐观与积极，深深感染了我，带我领略了西安的风土人情，品尝了无数美食，让我在繁重的课业中，依然保持了热情与动力。

我还要感谢课题组的各位老师：马志强老师、常海涛老师、刘星老师、沈刚辉老师、张夷斋老师、刘正雄老师，感谢你们在科研工作中的指导和帮助。你们的经验和建议让我在科学研究的道路上少走了许多弯路。还要感谢韩冬、陈海飞、黄冰潇、李陇南、李沅澔、赵亚坤、王志祥、宋梦实、张校祯、余航、高家乐、裴崇旭、翟晨萌、杨通等师兄师姐，感谢你们在学术上和生活中给予的帮助与关怀，让我的研究生生活更加丰富多彩。

再次感谢所有在我求学旅程中给予过帮助的人。你们的支持与鼓励，是我不断前行的不竭动力。未来的路上，我将继续努力，不忘初心，勇敢追求更高的目标。
\end{acknowledgements}                                      % 致谢结束
%%-----------------------------------------------------------------------------%
\begin{accomplishments}                                     % 参加科研情况开始
	论文发表情况
	\begin{enumerate}
		\item \blackbox{Ao Jin}, \blackbox{Chenhao Li}, \blackbox{Ya Liu}， \blackbox{Panfeng Huang} and \blackbox{Fan Zhang}. Neural Predictor for Flight Control with Payload [J].  IEEE Robotics
		and Automation Letters, 2024（中科院SCI 计算机科学类2 区, IF=4.6, 一审中）
	\end{enumerate}

    专利申请情况：
    \begin{enumerate}
    	\item \blackbox{张帆}, \blackbox{李晨豪}等. 一种柔性约束多智能体系统的协同运输鲁棒控制方法（发明专利，申请号/专利号：2024112841675）
    \end{enumerate}
\end{accomplishments}                                       % 参加科研情况结束
%%-----------------------------------------------------------------------------%
\makestatement                                              % 知识产权与原创性声明
%%=============================================================================%
%% 文档结束
%%-----------------------------------------------------------------------------%
\end{document}
%%=============================================================================%


%% 
%% This work consists of the file  yanputhesis.dtx
%% and the derived files           yanputhesis.ins,
%%                                 yanputhesis.pdf,
%%                                 yanputhesis.cls.
%% 
%%
%% End of file `yanputhesis-sample.tex'.
